---
文档类型: 知识库文档
需求编号: DOC-2025-11-004
创建日期: 2025-11-26
创建者: claude-sonnet-4-5 (claude-sonnet-4-5-20250929)
最后更新: 2025-11-26
更新者: claude-sonnet-4-5 (claude-sonnet-4-5-20250929)
状态: 已批准
---

# Python 代码规范 - 5. 类型注解

### 5.1 使用类型注解

```python
from typing import List, Dict, Optional, Union, Any

# ✅ 正确：函数参数和返回值都有类型注解
def analyze_document(
    doc_id: str,
    options: Optional[Dict[str, Any]] = None
) -> Dict[str, Union[str, List[str]]]:
    """分析文档"""
    if options is None:
        options = {}

    return {
        "summary": "文档摘要",
        "keywords": ["关键词1", "关键词2"],
    }

# ✅ 正确：变量类型注解
user_name: str = "John"
age: int = 30
scores: List[float] = [85.5, 90.0, 88.5]
metadata: Dict[str, Any] = {"key": "value"}

# ✅ 正确：类属性类型注解
class DocumentParser:
    max_size: int
    supported_formats: List[str]

    def __init__(self):
        self.max_size = 1024 * 1024
        self.supported_formats = ["pdf", "docx"]
```

### 5.2 复杂类型

```python
from typing import (
    List, Dict, Set, Tuple, Optional, Union, Any,
    Callable, TypeVar, Generic
)

# 函数类型
Callback = Callable[[str, int], bool]

def register_callback(callback: Callback) -> None:
    pass

# 泛型
T = TypeVar('T')

def first_element(items: List[T]) -> Optional[T]:
    return items[0] if items else None

# 多种可能的类型
def process_input(data: Union[str, bytes, dict]) -> str:
    if isinstance(data, str):
        return data
    elif isinstance(data, bytes):
        return data.decode()
    else:
        return str(data)

# Optional 等价于 Union[X, None]
def find_user(user_id: str) -> Optional[dict]:
    pass
```

---
