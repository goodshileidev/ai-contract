# Java Spring Boot 服务任务详细计划 - JAVA-001 Part1 - 1.1 用户管理基础功能 - 1.3.2 前端

#### 登录页面（ProForm）

```typescript
// frontend/src/pages/Auth/Login.tsx
import React from 'react';
import { ProForm, ProFormText, ProFormCheckbox } from '@ant-design/pro-components';
import { message } from 'antd';
import { UserOutlined, LockOutlined } from '@ant-design/icons';
import { useNavigate, Link } from 'react-router-dom';
import { authService, LoginRequest } from '@/services/auth.service';
import { TokenStorage } from '@/utils/auth';
import './Login.css';

/**
 * 登录页面
 * 需求编号: REQ-JAVA-001
 */
const LoginPage: React.FC = () => {
  const navigate = useNavigate();

  const handleSubmit = async (values: LoginRequest & { remember?: boolean }) => {
    try {
      const { remember, ...loginData } = values;

      // 调用登录API
      const response = await authService.login(loginData);

      // 保存Token
      TokenStorage.saveTokens(
        response.accessToken,
        response.refreshToken,
        response.expiresIn
      );

      // 记住邮箱
      if (remember) {
        localStorage.setItem('remember_email', loginData.emailOrUsername);
      } else {
        localStorage.removeItem('remember_email');
      }

      message.success('登录成功！');

      // 跳转到工作台
      navigate('/dashboard');

      return true; // ProForm要求返回true
    } catch (error: any) {
      message.error(error.message || '登录失败，请检查用户名和密码');
      return false;
    }
  };

  // 获取记住的邮箱
  const rememberedEmail = localStorage.getItem('remember_email');

  return (
    <div className="login-page">
      <div className="login-container">
        <div className="login-header">
          <h2>用户登录</h2>
          <p>AI标书智能创作平台</p>
        </div>

        <ProForm
          name="login"
          initialValues={{
            emailOrUsername: rememberedEmail || '',
            remember: !!rememberedEmail,
          }}
          onFinish={handleSubmit}
          submitter={{
            searchConfig: {
              submitText: '登录',
            },
            render: (_, dom) => dom[1], // 只显示提交按钮
            submitButtonProps: {
              size: 'large',
              block: true,
            },
          }}
          autoFocusFirstInput
        >
          <ProFormText
            name="emailOrUsername"
            fieldProps={{
              size: 'large',
              prefix: <UserOutlined />,
              placeholder: '邮箱或用户名',
            }}
            rules={[
              { required: true, message: '请输入邮箱或用户名' },
            ]}
          />

          <ProFormText.Password
            name="password"
            fieldProps={{
              size: 'large',
              prefix: <LockOutlined />,
              placeholder: '密码',
            }}
            rules={[
              { required: true, message: '请输入密码' },
            ]}
          />

          <div className="login-options">
            <ProFormCheckbox name="remember">记住我</ProFormCheckbox>
            <Link to="/forgot-password" className="login-forgot">
              忘记密码?
            </Link>
          </div>

          <div className="login-register" style={{ marginTop: 16 }}>
            还没有账号? <Link to="/register">立即注册</Link>
          </div>
        </ProForm>
      </div>
    </div>
  );
};

export default LoginPage;
```

#### 注册页面（ProForm）

```typescript
// frontend/src/pages/Auth/Register.tsx
import React from 'react';
import { ProForm, ProFormText } from '@ant-design/pro-components';
import { message } from 'antd';
import { UserOutlined, LockOutlined, MailOutlined } from '@ant-design/icons';
import { useNavigate, Link } from 'react-router-dom';
import { authService, RegisterRequest } from '@/services/auth.service';

/**
 * 注册页面
 * 需求编号: REQ-JAVA-001
 */
const RegisterPage: React.FC = () => {
  const navigate = useNavigate();

  const handleSubmit = async (values: RegisterRequest) => {
    try {
      await authService.register(values);

      message.success('注册成功！请登录。');

      // 跳转到登录页
      navigate('/login');

      return true;
    } catch (error: any) {
      message.error(error.message || '注册失败');
      return false;
    }
  };

  return (
    <div className="register-page">
      <div className="register-container">
        <div className="register-header">
          <h2>用户注册</h2>
          <p>AI标书智能创作平台</p>
        </div>

        <ProForm
          name="register"
          onFinish={handleSubmit}
          submitter={{
            searchConfig: {
              submitText: '注册',
            },
            render: (_, dom) => dom[1],
            submitButtonProps: {
              size: 'large',
              block: true,
            },
          }}
          autoFocusFirstInput
        >
          <ProFormText
            name="email"
            fieldProps={{
              size: 'large',
              prefix: <MailOutlined />,
              placeholder: '邮箱地址',
            }}
            rules={[
              { required: true, message: '请输入邮箱地址' },
              { type: 'email', message: '请输入有效的邮箱地址' },
            ]}
          />

          <ProFormText
            name="username"
            fieldProps={{
              size: 'large',
              prefix: <UserOutlined />,
              placeholder: '用户名',
            }}
            rules={[
              { required: true, message: '请输入用户名' },
              { min: 3, max: 50, message: '用户名长度必须在3-50之间' },
            ]}
          />

          <ProFormText
            name="fullName"
            fieldProps={{
              size: 'large',
              prefix: <UserOutlined />,
              placeholder: '姓名（可选）',
            }}
          />

          <ProFormText.Password
            name="password"
            fieldProps={{
              size: 'large',
              prefix: <LockOutlined />,
              placeholder: '密码（至少8个字符）',
            }}
            rules={[
              { required: true, message: '请输入密码' },
              { min: 8, message: '密码至少8个字符' },
            ]}
          />

          <ProFormText.Password
            name="confirmPassword"
            fieldProps={{
              size: 'large',
              prefix: <LockOutlined />,
              placeholder: '确认密码',
            }}
            rules={[
              { required: true, message: '请确认密码' },
              ({ getFieldValue }) => ({
                validator(_, value) {
                  if (!value || getFieldValue('password') === value) {
                    return Promise.resolve();
                  }
                  return Promise.reject(new Error('两次输入的密码不一致'));
                },
              }),
            ]}
          />

          <div className="register-login" style={{ marginTop: 16 }}>
            已有账号? <Link to="/login">立即登录</Link>
          </div>
        </ProForm>
      </div>
    </div>
  );
};

export default RegisterPage;
```

#### 认证服务（API Client）

```typescript
// frontend/src/services/auth.service.ts
import axios from 'axios';
import { TokenStorage } from '@/utils/auth';

export interface RegisterRequest {
  email: string;
  username: string;
  password: string;
  fullName?: string;
  organizationName?: string;
}

export interface LoginRequest {
  emailOrUsername: string;
  password: string;
  rememberMe?: boolean;
}

export interface LoginResponse {
  accessToken: string;
  refreshToken: string;
  tokenType: string;
  expiresIn: number;
  user: {
    id: string;
    email: string;
    username: string;
    fullName: string;
  };
}

class AuthService {
  private baseURL = 'http://localhost:8080/api/v1/auth';

  /**
   * 用户注册
   */
  async register(data: RegisterRequest): Promise<void> {
    await axios.post(`${this.baseURL}/register`, data);
  }

  /**
   * 用户登录
   */
  async login(data: LoginRequest): Promise<LoginResponse> {
    const response = await axios.post<{ success: boolean; data: LoginResponse }>(
      `${this.baseURL}/login`,
      data
    );
    return response.data.data;
  }

  /**
   * 用户登出
   */
  async logout(): Promise<void> {
    const token = TokenStorage.getAccessToken();
    if (token) {
      await axios.post(`${this.baseURL}/logout`, {}, {
        headers: { Authorization: `Bearer ${token}` },
      });
    }
    TokenStorage.clearTokens();
  }

  /**
   * 刷新Token
   */
  async refreshToken(): Promise<LoginResponse> {
    const refreshToken = TokenStorage.getRefreshToken();
    if (!refreshToken) {
      throw new Error('No refresh token available');
    }

    const response = await axios.post<{ success: boolean; data: LoginResponse }>(
      `${this.baseURL}/refresh`,
      { refreshToken }
    );

    return response.data.data;
  }

  /**
   * 获取当前用户信息
   */
  async getCurrentUser(): Promise<any> {
    const token = TokenStorage.getAccessToken();
    const response = await axios.get(`${this.baseURL}/me`, {
      headers: { Authorization: `Bearer ${token}` },
    });
    return response.data.data;
  }
}

export const authService = new AuthService();
```

**验证标准**:
- [ ] 登录页面正确渲染
- [ ] 注册页面正确渲染
- [ ] 表单验证正确
- [ ] API 调用成功
- [ ] Token 正确存储
- [ ] 登录成功跳转到工作台
- [ ] 记住我功能正常
