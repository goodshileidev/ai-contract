---
文档类型: 知识库文档
需求编号: DOC-2025-11-004
创建日期: 2025-11-26
创建者: claude-sonnet-4-5 (claude-sonnet-4-5-20250929)
最后更新: 2025-11-26
更新者: claude-sonnet-4-5 (claude-sonnet-4-5-20250929)
状态: 已批准
---

# Python 代码规范 - 9. 项目特定补充规范

### 9.1 需求编号标注

```python
"""
文档解析模块

需求编号: REQ-AI-001
实现日期: 2025-11-26
"""

class DocumentParser:
    """
    文档解析器

    需求编号: REQ-AI-001
    """

    def parse_pdf(self, file_path: str) -> dict:
        """
        解析 PDF 文档

        需求编号: REQ-AI-001

        Args:
            file_path: PDF 文件路径

        Returns:
            解析结果
        """
        # 需求编号: REQ-AI-001 - PDF 解析功能
        logger.debug(f"开始解析 PDF: {file_path}")
        # ... 实现代码
```

### 9.2 日志规范

```python
import logging

# ✅ 使用模块级 logger
logger = logging.getLogger(__name__)

class AIService:

    async def analyze_document(self, doc_id: str) -> dict:
        """分析文档"""

        # DEBUG：调试信息
        logger.debug(f"开始分析文档: {doc_id}")

        # INFO：重要业务流程
        logger.info(f"文档分析成功: {doc_id}")

        # WARNING：警告但不影响流程
        logger.warning(f"文档部分内容无法解析: {doc_id}")

        # ERROR：错误异常
        try:
            result = await self._call_llm(doc_id)
        except Exception as e:
            logger.error(f"调用 LLM 失败: {doc_id}", exc_info=True)
            raise

        return result
```

### 9.3 异步编程规范

```python
import asyncio
from typing import List

# ✅ 使用 async/await
async def fetch_document(doc_id: str) -> dict:
    """异步获取文档"""
    async with httpx.AsyncClient() as client:
        response = await client.get(f"/api/documents/{doc_id}")
        return response.json()

# ✅ 并发处理多个任务
async def fetch_multiple_documents(doc_ids: List[str]) -> List[dict]:
    """并发获取多个文档"""
    tasks = [fetch_document(doc_id) for doc_id in doc_ids]
    results = await asyncio.gather(*tasks, return_exceptions=True)
    return [r for r in results if not isinstance(r, Exception)]

# ✅ 使用 async 上下文管理器
async def process_with_lock():
    """使用异步锁"""
    async with asyncio.Lock():
        # 临界区代码
        pass
```

---
