---
文档类型: 知识库文档
需求编号: DOC-2025-11-004
创建日期: 2025-11-26
创建者: claude-sonnet-4-5 (claude-sonnet-4-5-20250929)
最后更新: 2025-11-26
更新者: claude-sonnet-4-5 (claude-sonnet-4-5-20250929)
状态: 已批准
---

# Python 代码规范 - 2. 格式化规范

### 2.1 缩进

- **4个空格** 为一个缩进层级
- **禁止使用 Tab**
- **禁止混用 Tab 和空格**

```python
# ✅ 正确：4空格缩进
def process_document(document: Document) -> dict:
    if document.is_valid():
        result = analyze_content(document.content)
        return result
    else:
        raise ValueError("无效的文档")
```

### 2.2 行长度

- **每行最多 79 字符**（代码）
- **每行最多 72 字符**（文档字符串和注释）
- 长 URL 等可以例外

```python
# ✅ 正确：超长行使用括号换行
user = User(
    username="john_doe",
    email="john@example.com",
    first_name="John",
    last_name="Doe"
)

# ✅ 正确：长字符串换行
message = (
    "这是一个很长的消息，"
    "需要分成多行来表示，"
    "以保持代码的可读性。"
)

# ✅ 正确：使用反斜杠续行（最后手段）
with open('/path/to/some/file/you/want/to/read') as file_1, \
     open('/path/to/some/file/being/written', 'w') as file_2:
    file_2.write(file_1.read())
```

### 2.3 空行

```python
# ✅ 顶级定义之间空两行
class DocumentParser:
    """文档解析器"""
    pass


class VectorStoreManager:
    """向量存储管理器"""
    pass


# ✅ 方法定义之间空一行
class AIService:

    def __init__(self):
        self.index = None

    def analyze_document(self, doc_id: str) -> dict:
        """分析文档"""
        pass

    def generate_content(self, prompt: str) -> str:
        """生成内容"""
        pass
```

### 2.4 空格

```python
# ✅ 正确：运算符两侧有空格
x = y + z
if x == y:
    pass

# ✅ 正确：逗号后有空格
my_list = [1, 2, 3]
my_dict = {"key": "value"}

# ✅ 正确：冒号在字典中的使用
{"key": "value"}  # 冒号后有空格，前面没有

# ❌ 错误：多余的空格
my_list = [ 1, 2, 3 ]  # ❌ 括号内不要空格
my_dict = { "key":"value" }  # ❌ 格式不对

# ✅ 正确：函数调用
func(arg1, arg2, kwarg1=value1, kwarg2=value2)

# ❌ 错误：多余的空格
func( arg1, arg2 )  # ❌ 括号内不要空格
func(arg1 , arg2)   # ❌ 逗号前不要空格
```

### 2.5 尾随逗号

```python
# ✅ 推荐：多行时使用尾随逗号（方便版本控制）
FILES = [
    "setup.py",
    "main.py",
    "config.py",  # ✅ 尾随逗号
]

# ✅ 单行时不需要尾随逗号
FILES = ["setup.py", "main.py", "config.py"]
```

---
