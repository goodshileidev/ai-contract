# React 前端任务计划

**文档类型**: 实现文档
**需求编号**: REQ-FRONT-001 ~ REQ-FRONT-004
**创建日期**: 2025-11-26
**创建者**: claude-sonnet-4-5 (claude-sonnet-4-5-20250929)
**最后更新**: 2025-11-26
**更新者**: claude-sonnet-4-5 (claude-sonnet-4-5-20250929)
**状态**: 待开始

---

## 修改历史

| 日期 | 版本 | 修改者 | 修改内容概要 |
|------|------|--------|-------------|
| 2025-11-26 | 1.0 | claude-sonnet-4-5 (claude-sonnet-4-5-20250929) | 从task-plan.md拆分出React前端任务 |

---

## 模块概述

本模块包含 React 前端的所有用户界面开发任务，负责：
- 基础框架和布局
- 用户和项目管理界面
- 文档编辑和预览界面
- AI助手交互界面

**技术栈**: React 18 + TypeScript 5.x + Ant Design Pro 6.x + Umi 4.x

**总体进度**: 0% (0/4 任务完成)

---

## FRONT-001: 基础框架和布局

**需求编号**: REQ-FRONT-001
**负责人**: 前端开发
**优先级**: P1 - 高优先级
**开始时间**: YYYY-MM-DD
**预计完成**: YYYY-MM-DD
**实际完成**: -
**当前状态**: ⏸️ 待开始
**完成进度**: 0% (0/5 子任务)

### 子任务清单

#### 1. 项目脚手架搭建
**完成进度**: 0/4
- [ ] Ant Design Pro 初始化
- [ ] TypeScript 配置
- [ ] Umi 路由配置
- [ ] ESLint + Prettier 配置

#### 2. 全局布局
**完成进度**: 0/5
- [ ] ProLayout 配置
- [ ] 顶部导航栏
- [ ] 侧边菜单
- [ ] 面包屑导航
- [ ] 页脚

#### 3. 主题配置
**完成进度**: 0/3
- [ ] Ant Design 主题定制
- [ ] 深色模式支持
- [ ] 主题切换功能

#### 4. API 客户端配置
**完成进度**: 0/4
- [ ] axios 封装
- [ ] 请求拦截器（添加 Token）
- [ ] 响应拦截器（错误处理）
- [ ] 双服务端点配置（Java + Python）

#### 5. 全局状态管理
**完成进度**: 0/3
- [ ] 用户状态管理
- [ ] 组织和项目上下文
- [ ] 权限状态管理

### 技术实现要点

**API 客户端配置**:
```typescript
// src/services/api.ts
import axios from 'axios';

// Java 服务客户端
const javaClient = axios.create({
  baseURL: 'http://localhost:8080',
  timeout: 30000,
});

// Python AI 服务客户端
const pythonClient = axios.create({
  baseURL: 'http://localhost:8001',
  timeout: 60000,  // AI 接口可能较慢
});

// 请求拦截器
javaClient.interceptors.request.use(config => {
  const token = localStorage.getItem('access_token');
  if (token) {
    config.headers.Authorization = `Bearer ${token}`;
  }
  return config;
});

// 响应拦截器
javaClient.interceptors.response.use(
  response => response,
  error => {
    if (error.response?.status === 401) {
      // Token 过期，跳转登录
      window.location.href = '/login';
    }
    return Promise.reject(error);
  }
);
```

**ProLayout 配置**:
```typescript
// src/app.tsx
import { ProLayoutProps } from '@ant-design/pro-layout';

export const layout: ProLayoutProps = {
  title: 'AI标书智能创作平台',
  logo: '/logo.svg',
  layout: 'mix',
  theme: 'light',
  navTheme: 'light',
  primaryColor: '#1890ff',
  contentWidth: 'Fluid',
  fixedHeader: true,
  fixSiderbar: true,
};
```

---

## FRONT-002: 用户和项目管理界面

**需求编号**: REQ-FRONT-002
**优先级**: P1 - 高优先级
**当前状态**: ⏸️ 待开始
**完成进度**: 0% (0/4 子任务)

### 子任务清单

#### 1. 登录注册页面
**完成进度**: 0/4
- [ ] 登录表单（ProForm）
- [ ] 注册表单
- [ ] 忘记密码流程
- [ ] 第三方登录（预留）

#### 2. 用户中心
**完成进度**: 0/4
- [ ] 个人资料展示
- [ ] 资料编辑表单
- [ ] 密码修改
- [ ] 头像上传

#### 3. 组织管理
**完成进度**: 0/4
- [ ] 组织列表页面（ProTable）
- [ ] 组织详情页面
- [ ] 组织创建/编辑表单
- [ ] 组织成员管理

#### 4. 项目管理
**完成进度**: 0/4
- [ ] 项目看板视图
- [ ] 项目列表视图
- [ ] 项目详情页面
- [ ] 项目创建/编辑表单

### 技术实现要点

**ProForm 登录表单**:
```typescript
// src/pages/Login/index.tsx
import { ProForm, ProFormText } from '@ant-design/pro-form';
import { LockOutlined, UserOutlined } from '@ant-design/icons';

const Login: React.FC = () => {
  const handleSubmit = async (values: any) => {
    const response = await login(values);
    if (response.success) {
      localStorage.setItem('access_token', response.data.access_token);
      history.push('/');
    }
  };

  return (
    <ProForm onFinish={handleSubmit}>
      <ProFormText
        name="email"
        placeholder="邮箱"
        prefix={<UserOutlined />}
        rules={[{ required: true, type: 'email' }]}
      />
      <ProFormText.Password
        name="password"
        placeholder="密码"
        prefix={<LockOutlined />}
        rules={[{ required: true, min: 8 }]}
      />
    </ProForm>
  );
};
```

**ProTable 项目列表**:
```typescript
// src/pages/Projects/index.tsx
import { ProTable } from '@ant-design/pro-table';

const Projects: React.FC = () => {
  const columns = [
    { title: '项目名称', dataIndex: 'name', key: 'name' },
    { title: '项目编号', dataIndex: 'code', key: 'code' },
    { title: '状态', dataIndex: 'status', key: 'status' },
    { title: '创建时间', dataIndex: 'created_at', key: 'created_at' },
  ];

  return (
    <ProTable
      columns={columns}
      request={async (params) => {
        const response = await getProjects(params);
        return {
          data: response.data.items,
          total: response.data.total,
          success: true,
        };
      }}
      rowKey="id"
      search={{
        labelWidth: 'auto',
      }}
      pagination={{
        defaultPageSize: 20,
      }}
    />
  );
};
```

---

## FRONT-003: 文档编辑和预览界面

**需求编号**: REQ-FRONT-003
**优先级**: P2 - 中优先级
**当前状态**: ⏸️ 待开始
**完成进度**: 0% (0/5 子任务)

### 子任务清单

#### 1. 富文本编辑器集成
**完成进度**: 0/4
- [ ] 选择编辑器（TinyMCE/Quill/Slate）
- [ ] 工具栏定制
- [ ] 图片上传
- [ ] 表格支持

#### 2. 文档大纲
**完成进度**: 0/3
- [ ] 自动生成大纲
- [ ] 大纲导航
- [ ] 章节折叠展开

#### 3. 文档预览
**完成进度**: 0/3
- [ ] PDF 预览
- [ ] Word 预览
- [ ] 打印预览

#### 4. 版本管理界面
**完成进度**: 0/3
- [ ] 版本历史列表
- [ ] 版本比较视图
- [ ] 版本回退操作

#### 5. 模板应用
**完成进度**: 0/3
- [ ] 模板选择器
- [ ] 模板预览
- [ ] 应用模板到文档

### 技术实现要点

**富文本编辑器（推荐使用 Slate）**:
```typescript
// src/components/RichEditor/index.tsx
import { Slate, Editable, withReact } from 'slate-react';
import { createEditor } from 'slate';
import { useMemo, useState } from 'react';

const RichEditor: React.FC = () => {
  const editor = useMemo(() => withReact(createEditor()), []);
  const [value, setValue] = useState([
    {
      type: 'paragraph',
      children: [{ text: '开始编辑...' }],
    },
  ]);

  return (
    <Slate editor={editor} value={value} onChange={setValue}>
      <Editable placeholder="输入内容..." />
    </Slate>
  );
};
```

**文档大纲导航**:
```typescript
// src/components/DocumentOutline/index.tsx
import { Anchor } from 'antd';

const DocumentOutline: React.FC<{ sections: any[] }> = ({ sections }) => {
  return (
    <Anchor>
      {sections.map(section => (
        <Anchor.Link
          key={section.id}
          href={`#section-${section.id}`}
          title={section.title}
        />
      ))}
    </Anchor>
  );
};
```

---

## FRONT-004: AI助手交互界面

**需求编号**: REQ-FRONT-004
**优先级**: P1 - 高优先级
**当前状态**: ⏸️ 待开始
**完成进度**: 0% (0/4 子任务)

### 子任务清单

#### 1. 招标文件上传和解析
**完成进度**: 0/4
- [ ] 文件上传组件（ProUpload）
- [ ] 解析进度展示
- [ ] 解析结果展示
- [ ] 关键信息提取结果

#### 2. AI内容生成界面
**完成进度**: 0/4
- [ ] 生成配置面板
- [ ] 生成进度展示
- [ ] 生成结果展示
- [ ] 结果编辑和接受

#### 3. AI助手对话
**完成进度**: 0/4
- [ ] 聊天界面
- [ ] 消息列表
- [ ] 输入框和发送
- [ ] 打字动画效果

#### 4. 智能推荐展示
**完成进度**: 0/4
- [ ] 相似项目卡片
- [ ] 案例推荐列表
- [ ] 模板推荐
- [ ] 一键应用推荐

### 技术实现要点

**文件上传组件**:
```typescript
// src/components/FileUpload/index.tsx
import { ProUpload } from '@ant-design/pro-upload';

const FileUpload: React.FC = () => {
  const handleUpload = async (file: File) => {
    const formData = new FormData();
    formData.append('file', file);

    const response = await pythonClient.post('/api/ai/parse-document', formData);

    return {
      success: true,
      data: response.data,
    };
  };

  return (
    <ProUpload
      name="file"
      accept=".pdf,.docx,.doc"
      maxCount={1}
      customRequest={handleUpload}
    />
  );
};
```

**AI 对话界面**:
```typescript
// src/components/AIChatbot/index.tsx
import { useState } from 'react';
import { Input, Button, List, Avatar } from 'antd';
import { RobotOutlined, UserOutlined } from '@ant-design/icons';

interface Message {
  role: 'user' | 'assistant';
  content: string;
}

const AIChatbot: React.FC = () => {
  const [messages, setMessages] = useState<Message[]>([]);
  const [input, setInput] = useState('');
  const [loading, setLoading] = useState(false);

  const handleSend = async () => {
    const userMessage = { role: 'user' as const, content: input };
    setMessages([...messages, userMessage]);
    setLoading(true);

    try {
      const response = await pythonClient.post('/api/ai/chat', {
        messages: [...messages, userMessage],
      });

      setMessages([
        ...messages,
        userMessage,
        { role: 'assistant', content: response.data.content },
      ]);
    } finally {
      setLoading(false);
      setInput('');
    }
  };

  return (
    <div>
      <List
        dataSource={messages}
        renderItem={(msg) => (
          <List.Item>
            <List.Item.Meta
              avatar={
                <Avatar icon={msg.role === 'user' ? <UserOutlined /> : <RobotOutlined />} />
              }
              title={msg.role === 'user' ? '我' : 'AI助手'}
              description={msg.content}
            />
          </List.Item>
        )}
      />
      <Input.Search
        value={input}
        onChange={(e) => setInput(e.target.value)}
        onSearch={handleSend}
        loading={loading}
        placeholder="输入消息..."
        enterButton="发送"
      />
    </div>
  );
};
```

---

## 技术栈和工具

### 核心框架
- **React**: 18.2+
- **TypeScript**: 5.0+
- **Umi**: 4.x
- **Ant Design**: 5.x
- **Ant Design Pro**: 6.x

### Pro Components
- **ProLayout**: 页面布局
- **ProTable**: 高级表格
- **ProForm**: 高级表单
- **ProCard**: 高级卡片
- **ProList**: 高级列表

### 状态管理
- **@umijs/max**: Umi 集成方案
- **TanStack Query**: 服务端状态管理
- **Zustand**: 客户端状态管理（可选）

### UI 增强
- **ahooks**: React Hooks 库
- **react-use**: React Hooks 工具
- **@ant-design/icons**: Ant Design 图标
- **@ant-design/pro-icons**: Pro Icons

### 工具库
- **axios**: HTTP 客户端
- **dayjs**: 日期处理
- **lodash-es**: 工具函数
- **classnames**: CSS 类名处理

### 开发工具
- **Vite**: 构建工具
- **ESLint**: 代码检查
- **Prettier**: 代码格式化
- **Stylelint**: 样式检查

---

## 开发规范

### 代码规范
- 使用 TypeScript 严格模式
- 使用函数组件 + Hooks
- 使用 ESLint + Prettier 格式化
- 遵循 Ant Design 设计规范

### 命名规范
- **组件**: 大驼峰，如 `UserList`
- **文件**: 大驼峰，如 `UserList.tsx`
- **函数**: 小驼峰，如 `getUserList`
- **常量**: 全大写+下划线，如 `API_BASE_URL`

### 目录结构
```
src/
├── pages/           # 页面组件
├── components/      # 通用组件
├── services/        # API 服务
├── models/          # 数据模型
├── utils/           # 工具函数
├── hooks/           # 自定义 Hooks
├── layouts/         # 布局组件
└── app.tsx          # 应用入口
```

### 组件开发
- 使用 React.FC 类型
- Props 使用 interface 定义
- 使用 useMemo 和 useCallback 优化性能
- 组件拆分要合理，避免过大

---

## 里程碑

### M2: 基础界面完成（2026-01-15）
- [ ] FRONT-001: 基础框架完成
- [ ] FRONT-002: 用户管理界面完成
- [ ] 所有基础页面可访问
- [ ] 与后端 API 集成测试通过

### M3: 核心功能界面完成（2026-02-15）
- [ ] FRONT-003: 文档编辑界面完成
- [ ] FRONT-004: AI助手界面完成
- [ ] 端到端用户流程测试通过
- [ ] UI/UX 评审通过

---

## 常用命令

### 开发
```bash
# 安装依赖
npm install

# 启动开发服务器
npm run dev

# 构建生产版本
npm run build

# 预览生产构建
npm run preview
```

### 代码质量
```bash
# ESLint 检查
npm run lint

# 修复 ESLint 问题
npm run lint:fix

# Prettier 格式化
npm run prettier

# TypeScript 类型检查
npm run tsc
```

### 测试
```bash
# 运行单元测试
npm test

# 运行 E2E 测试
npm run test:e2e

# 查看测试覆盖率
npm run test:coverage
```

---

**返回**: [任务计划总览](./task-plan.md)
