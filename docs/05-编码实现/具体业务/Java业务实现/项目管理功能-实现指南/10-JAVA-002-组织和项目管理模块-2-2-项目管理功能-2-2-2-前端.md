# Java Spring Boot - JAVA-002 Part1 (组织管理: 数据+前端) - JAVA-002: 组织和项目管理模块 - 2.2: 项目管理功能 - 2.2.2: 前端

**验证清单**:
- [ ] 项目列表页面组件完成
- [ ] 项目创建/编辑表单完成
- [ ] 项目详情页面完成
- [ ] 项目成员管理组件完成
- [ ] 项目里程碑管理组件完成
- [ ] API Service 集成完成
- [ ] 状态管理配置完成
- [ ] 路由配置完成

##### 项目列表页面 (`ProjectList.tsx`)

```typescript
// apps/frontend/src/pages/project/ProjectList.tsx
// 需求编号: REQ-JAVA-002
// 技术选型: ProTable + TanStack Query
import React, { useRef } from 'react';
import { ProTable, type ProColumns, type ActionType } from '@ant-design/pro-table';
import { Button, Tag, Space, Popconfirm, message } from 'antd';
import { PlusOutlined, EditOutlined, DeleteOutlined, EyeOutlined } from '@ant-design/icons';
import { useNavigate } from '@umijs/max';
import { useQuery, useMutation, useQueryClient } from '@tanstack/react-query';
import { projectService, type ProjectSimpleDTO, type ProjectQueryParams } from '@/services/project.service';
import dayjs from 'dayjs';

/**
 * 项目列表页面
 * 需求编号: REQ-JAVA-002
 */
const ProjectList: React.FC = () => {
  const navigate = useNavigate();
  const queryClient = useQueryClient();
  const actionRef = useRef<ActionType>();

  // 删除项目 Mutation
  const deleteProjectMutation = useMutation({
    mutationFn: (id: string) => projectService.deleteProject(id),
    onSuccess: () => {
      message.success('项目删除成功');
      actionRef.current?.reload();
    },
    onError: (error: any) => {
      message.error(error.message || '删除失败');
    },
  });

  // 项目状态颜色映射
  const statusColorMap: Record<string, string> = {
    DRAFT: 'default',
    IN_PROGRESS: 'processing',
    REVIEW: 'warning',
    SUBMITTED: 'success',
    WON: 'success',
    LOST: 'error',
    ARCHIVED: 'default',
  };

  // 项目状态文本映射
  const statusTextMap: Record<string, string> = {
    DRAFT: '草稿',
    IN_PROGRESS: '进行中',
    REVIEW: '审核中',
    SUBMITTED: '已提交',
    WON: '中标',
    LOST: '落标',
    ARCHIVED: '已归档',
  };

  // 优先级颜色映射
  const priorityColorMap: Record<string, string> = {
    LOW: 'default',
    MEDIUM: 'blue',
    HIGH: 'orange',
    URGENT: 'red',
  };

  // 列定义
  const columns: ProColumns<ProjectSimpleDTO>[] = [
    {
      title: '项目编号',
      dataIndex: 'code',
      width: 140,
      fixed: 'left',
      copyable: true,
    },
    {
      title: '项目名称',
      dataIndex: 'name',
      width: 200,
      fixed: 'left',
      ellipsis: true,
      render: (_, record) => (
        <a onClick={() => navigate(`/projects/${record.id}`)}>
          {record.name}
        </a>
      ),
    },
    {
      title: '所属组织',
      dataIndex: 'organizationName',
      width: 150,
      ellipsis: true,
      hideInSearch: true,
    },
    {
      title: '状态',
      dataIndex: 'status',
      width: 100,
      valueType: 'select',
      valueEnum: {
        DRAFT: { text: '草稿', status: 'Default' },
        IN_PROGRESS: { text: '进行中', status: 'Processing' },
        REVIEW: { text: '审核中', status: 'Warning' },
        SUBMITTED: { text: '已提交', status: 'Success' },
        WON: { text: '中标', status: 'Success' },
        LOST: { text: '落标', status: 'Error' },
        ARCHIVED: { text: '已归档', status: 'Default' },
      },
      render: (_, record) => (
        <Tag color={statusColorMap[record.status]}>
          {statusTextMap[record.status]}
        </Tag>
      ),
    },
    {
      title: '优先级',
      dataIndex: 'priority',
      width: 100,
      valueType: 'select',
      valueEnum: {
        LOW: { text: '低', status: 'Default' },
        MEDIUM: { text: '中', status: 'Processing' },
        HIGH: { text: '高', status: 'Warning' },
        URGENT: { text: '紧急', status: 'Error' },
      },
      render: (_, record) => (
        <Tag color={priorityColorMap[record.priority || 'MEDIUM']}>
          {record.priority || 'MEDIUM'}
        </Tag>
      ),
    },
    {
      title: '预算金额',
      dataIndex: 'budgetAmount',
      width: 120,
      hideInSearch: true,
      render: (_, record) => (
        record.budgetAmount
          ? `${record.budgetAmount.toLocaleString()} ${record.currency || 'CNY'}`
          : '-'
      ),
    },
    {
      title: '中标概率',
      dataIndex: 'winProbability',
      width: 100,
      hideInSearch: true,
      render: (_, record) => (
        record.winProbability != null
          ? `${record.winProbability}%`
          : '-'
      ),
    },
    {
      title: '进度',
      dataIndex: 'progress',
      width: 100,
      hideInSearch: true,
      render: (_, record) => `${record.progress || 0}%`,
    },
    {
      title: '投标截止',
      dataIndex: 'submissionDeadline',
      width: 160,
      valueType: 'dateTime',
      hideInSearch: true,
      render: (_, record) => (
        record.submissionDeadline
          ? dayjs(record.submissionDeadline).format('YYYY-MM-DD HH:mm')
          : '-'
      ),
    },
    {
      title: '创建时间',
      dataIndex: 'createdAt',
      width: 160,
      valueType: 'dateTime',
      hideInSearch: true,
      render: (_, record) => dayjs(record.createdAt).format('YYYY-MM-DD HH:mm'),
    },
    {
      title: '操作',
      width: 180,
      fixed: 'right',
      hideInSearch: true,
      render: (_, record) => (
        <Space size="small">
          <Button
            type="link"
            size="small"
            icon={<EyeOutlined />}
            onClick={() => navigate(`/projects/${record.id}`)}
          >
            查看
          </Button>
          <Button
            type="link"
            size="small"
            icon={<EditOutlined />}
            onClick={() => navigate(`/projects/${record.id}/edit`)}
          >
            编辑
          </Button>
          <Popconfirm
            title="确定删除这个项目吗？"
            description="删除后可以从回收站恢复"
            onConfirm={() => deleteProjectMutation.mutate(record.id)}
            okText="确定"
            cancelText="取消"
          >
            <Button
              type="link"
              size="small"
              danger
              icon={<DeleteOutlined />}
              loading={deleteProjectMutation.isPending}
            >
              删除
            </Button>
          </Popconfirm>
        </Space>
      ),
    },
  ];

  return (
    <ProTable<ProjectSimpleDTO>
      columns={columns}
      actionRef={actionRef}
      request={async (params, sort, filter) => {
        const queryParams: ProjectQueryParams = {
          page: params.current || 1,
          pageSize: params.pageSize || 20,
          status: params.status,
          priority: params.priority,
          search: params.keyword,
        };

        const response = await projectService.getProjects(queryParams);

        return {
          data: response.items,
          success: true,
          total: response.total,
        };
      }}
      rowKey="id"
      search={{
        labelWidth: 'auto',
      }}
      pagination={{
        defaultPageSize: 20,
        showSizeChanger: true,
        showQuickJumper: true,
      }}
      dateFormatter="string"
      headerTitle="项目列表"
      toolBarRender={() => [
        <Button
          key="create"
          type="primary"
          icon={<PlusOutlined />}
          onClick={() => navigate('/projects/create')}
        >
          新建项目
        </Button>,
      ]}
      scroll={{ x: 1500 }}
    />
  );
};

export default ProjectList;
```

##### 项目表单组件 (`ProjectForm.tsx`)

```typescript
// apps/frontend/src/pages/project/ProjectForm.tsx
// 需求编号: REQ-JAVA-002
// 技术选型: ProForm
import React, { useEffect } from 'react';
import {
  ProForm,
  ProFormText,
  ProFormTextArea,
  ProFormSelect,
  ProFormDatePicker,
  ProFormDateTimePicker,
  ProFormDigit,
} from '@ant-design/pro-form';
import { Card, message } from 'antd';
import { useNavigate, useParams } from '@umijs/max';
import { useMutation, useQuery } from '@tanstack/react-query';
import {
  projectService,
  type CreateProjectDTO,
  type UpdateProjectDTO,
} from '@/services/project.service';
import { organizationService } from '@/services/organization.service';

/**
 * 项目创建/编辑表单
 * 需求编号: REQ-JAVA-002
 */
const ProjectForm: React.FC = () => {
  const navigate = useNavigate();
  const { id } = useParams<{ id: string }>();
  const isEdit = !!id;

  const [form] = ProForm.useForm();

  // 获取项目详情（编辑模式）
  const { data: project, isLoading: projectLoading } = useQuery({
    queryKey: ['project', id],
    queryFn: () => projectService.getProjectById(id!),
    enabled: isEdit,
  });

  // 获取组织列表
  const { data: organizations } = useQuery({
    queryKey: ['organizations', 'all'],
    queryFn: () => organizationService.getOrganizations({ page: 1, pageSize: 1000 }),
  });

  // 创建项目 Mutation
  const createMutation = useMutation({
    mutationFn: (data: CreateProjectDTO) => projectService.createProject(data),
    onSuccess: (response) => {
      message.success('项目创建成功');
      navigate(`/projects/${response.id}`);
    },
    onError: (error: any) => {
      message.error(error.message || '创建失败');
    },
  });

  // 更新项目 Mutation
  const updateMutation = useMutation({
    mutationFn: (data: UpdateProjectDTO) => projectService.updateProject(id!, data),
    onSuccess: () => {
      message.success('项目更新成功');
      navigate(`/projects/${id}`);
    },
    onError: (error: any) => {
      message.error(error.message || '更新失败');
    },
  });

  // 编辑模式：回填表单数据
  useEffect(() => {
    if (isEdit && project) {
      form.setFieldsValue({
        name: project.name,
        description: project.description,
        organizationId: project.organizationId,
        biddingType: project.biddingType,
        industry: project.industry,
        budgetAmount: project.budgetAmount,
        currency: project.currency,
        startDate: project.startDate,
        endDate: project.endDate,
        submissionDeadline: project.submissionDeadline,
        priority: project.priority,
        winProbability: project.winProbability,
        tags: project.tags,
      });
    }
  }, [project, form, isEdit]);

  return (
    <Card title={isEdit ? '编辑项目' : '新建项目'} loading={projectLoading}>
      <ProForm
        form={form}
        onFinish={async (values) => {
          if (isEdit) {
            await updateMutation.mutateAsync(values as UpdateProjectDTO);
          } else {
            await createMutation.mutateAsync(values as CreateProjectDTO);
          }
          return true;
        }}
        submitter={{
          searchConfig: {
            resetText: '取消',
            submitText: isEdit ? '更新' : '创建',
          },
          resetButtonProps: {
            onClick: () => navigate(-1),
          },
          submitButtonProps: {
            loading: createMutation.isPending || updateMutation.isPending,
          },
        }}
        layout="vertical"
      >
        <ProForm.Group>
          <ProFormText
            name="name"
            label="项目名称"
            width="lg"
            placeholder="请输入项目名称"
            rules={[
              { required: true, message: '请输入项目名称' },
              { max: 200, message: '项目名称最多200字符' },
            ]}
          />

          <ProFormSelect
            name="organizationId"
            label="所属组织"
            width="md"
            showSearch
            placeholder="请选择组织"
            rules={[{ required: true, message: '请选择组织' }]}
            options={organizations?.items.map((org) => ({
              label: org.name,
              value: org.id,
            }))}
            disabled={isEdit}  // 编辑时不允许更改组织
          />
        </ProForm.Group>

        <ProFormTextArea
          name="description"
          label="项目描述"
          placeholder="请输入项目描述"
          fieldProps={{
            rows: 4,
            maxLength: 2000,
            showCount: true,
          }}
        />

        <ProForm.Group>
          <ProFormSelect
            name="biddingType"
            label="招标类型"
            width="md"
            placeholder="请选择招标类型"
            options={[
              { label: '政府采购', value: 'GOVERNMENT' },
              { label: '企业采购', value: 'ENTERPRISE' },
              { label: '国际招标', value: 'INTERNATIONAL' },
              { label: '其他', value: 'OTHER' },
            ]}
          />

          <ProFormText
            name="industry"
            label="所属行业"
            width="md"
            placeholder="请输入行业"
          />
        </ProForm.Group>

        <ProForm.Group>
          <ProFormDigit
            name="budgetAmount"
            label="项目预算"
            width="md"
            placeholder="请输入预算金额"
            fieldProps={{
              precision: 2,
              min: 0,
              addonAfter: (
                <ProFormSelect
                  name="currency"
                  noStyle
                  initialValue="CNY"
                  options={[
                    { label: 'CNY', value: 'CNY' },
                    { label: 'USD', value: 'USD' },
                    { label: 'EUR', value: 'EUR' },
                  ]}
                />
              ),
            }}
          />

          <ProFormSelect
            name="priority"
            label="优先级"
            width="sm"
            initialValue="MEDIUM"
            options={[
              { label: '低', value: 'LOW' },
              { label: '中', value: 'MEDIUM' },
              { label: '高', value: 'HIGH' },
              { label: '紧急', value: 'URGENT' },
            ]}
          />

          <ProFormDigit
            name="winProbability"
            label="中标概率（%）"
            width="sm"
            placeholder="0-100"
            fieldProps={{
              min: 0,
              max: 100,
              precision: 0,
            }}
          />
        </ProForm.Group>

        <ProForm.Group>
          <ProFormDatePicker
            name="startDate"
            label="开始日期"
            width="md"
          />

          <ProFormDatePicker
            name="endDate"
            label="结束日期"
            width="md"
          />

          <ProFormDateTimePicker
            name="submissionDeadline"
            label="投标截止时间"
            width="md"
          />
        </ProForm.Group>
      </ProForm>
    </Card>
  );
};

export default ProjectForm;
```

##### 项目详情页面 (`ProjectDetail.tsx`)

```typescript
// apps/frontend/src/pages/project/ProjectDetail.tsx
// 需求编号: REQ-JAVA-002
import React from 'react';
import { Card, Descriptions, Tag, Button, Space, Tabs, Spin, message } from 'antd';
import { EditOutlined, DeleteOutlined } from '@ant-design/icons';
import { useNavigate, useParams } from '@umijs/max';
import { useQuery, useMutation } from '@tanstack/react-query';
import { projectService } from '@/services/project.service';
import ProjectMemberList from './components/ProjectMemberList';
import ProjectMilestoneList from './components/ProjectMilestoneList';
import dayjs from 'dayjs';

/**
 * 项目详情页面
 * 需求编号: REQ-JAVA-002
 */
const ProjectDetail: React.FC = () => {
  const navigate = useNavigate();
  const { id } = useParams<{ id: string }>();

  // 获取项目详情
  const { data: project, isLoading } = useQuery({
    queryKey: ['project', id],
    queryFn: () => projectService.getProjectById(id!),
  });

  if (isLoading) {
    return <Spin size="large" style={{ display: 'block', margin: '100px auto' }} />;
  }

  if (!project) {
    return <div>项目不存在</div>;
  }

  const statusColorMap: Record<string, string> = {
    DRAFT: 'default',
    IN_PROGRESS: 'processing',
    REVIEW: 'warning',
    SUBMITTED: 'success',
    WON: 'success',
    LOST: 'error',
    ARCHIVED: 'default',
  };

  return (
    <div>
      <Card
        title={project.name}
        extra={
          <Space>
            <Button
              type="primary"
              icon={<EditOutlined />}
              onClick={() => navigate(`/projects/${id}/edit`)}
            >
              编辑
            </Button>
            <Button danger icon={<DeleteOutlined />}>
              删除
            </Button>
          </Space>
        }
      >
        <Descriptions column={3} bordered>
          <Descriptions.Item label="项目编号">{project.code}</Descriptions.Item>
          <Descriptions.Item label="状态">
            <Tag color={statusColorMap[project.status]}>{project.status}</Tag>
          </Descriptions.Item>
          <Descriptions.Item label="优先级">
            <Tag>{project.priority}</Tag>
          </Descriptions.Item>

          <Descriptions.Item label="所属组织" span={2}>
            {project.organizationName}
          </Descriptions.Item>
          <Descriptions.Item label="进度">
            {project.progress}%
          </Descriptions.Item>

          <Descriptions.Item label="招标类型">
            {project.biddingType || '-'}
          </Descriptions.Item>
          <Descriptions.Item label="所属行业">
            {project.industry || '-'}
          </Descriptions.Item>
          <Descriptions.Item label="中标概率">
            {project.winProbability != null ? `${project.winProbability}%` : '-'}
          </Descriptions.Item>

          <Descriptions.Item label="项目预算" span={3}>
            {project.budgetAmount
              ? `${project.budgetAmount.toLocaleString()} ${project.currency}`
              : '-'}
          </Descriptions.Item>

          <Descriptions.Item label="开始日期">
            {project.startDate ? dayjs(project.startDate).format('YYYY-MM-DD') : '-'}
          </Descriptions.Item>
          <Descriptions.Item label="结束日期">
            {project.endDate ? dayjs(project.endDate).format('YYYY-MM-DD') : '-'}
          </Descriptions.Item>
          <Descriptions.Item label="投标截止">
            {project.submissionDeadline
              ? dayjs(project.submissionDeadline).format('YYYY-MM-DD HH:mm')
              : '-'}
          </Descriptions.Item>

          <Descriptions.Item label="项目描述" span={3}>
            {project.description || '-'}
          </Descriptions.Item>

          <Descriptions.Item label="创建人">
            {project.createdByName}
          </Descriptions.Item>
          <Descriptions.Item label="创建时间">
            {dayjs(project.createdAt).format('YYYY-MM-DD HH:mm')}
          </Descriptions.Item>
          <Descriptions.Item label="更新时间">
            {dayjs(project.updatedAt).format('YYYY-MM-DD HH:mm')}
          </Descriptions.Item>
        </Descriptions>
      </Card>

      <Card style={{ marginTop: 16 }}>
        <Tabs
          items={[
            {
              key: 'members',
              label: `项目成员 (${project.memberCount})`,
              children: <ProjectMemberList projectId={id!} />,
            },
            {
              key: 'milestones',
              label: `里程碑 (${project.milestoneCount})`,
              children: <ProjectMilestoneList projectId={id!} />,
            },
            {
              key: 'documents',
              label: `文档 (${project.documentCount})`,
              children: <div>文档列表（待实现）</div>,
            },
          ]}
        />
      </Card>
    </div>
  );
};

export default ProjectDetail;
```

##### API Service (`project.service.ts`)

```typescript
// apps/frontend/src/services/project.service.ts
// 需求编号: REQ-JAVA-002
import axios from 'axios';

const API_BASE_URL = process.env.REACT_APP_API_BASE_URL || 'http://localhost:8080';

/**
 * 项目查询参数
 */
export interface ProjectQueryParams {
  page?: number;
  pageSize?: number;
  status?: string;
  priority?: string;
  organizationId?: string;
  search?: string;
  sortBy?: string;
  sortOrder?: 'asc' | 'desc';
}

/**
 * 项目简要信息 DTO
 */
export interface ProjectSimpleDTO {
  id: string;
  name: string;
  code: string;
  organizationName: string;
  status: string;
  priority: string;
  winProbability: number;
  budgetAmount: number;
  currency: string;
  submissionDeadline: string;
  progress: number;
  createdAt: string;
}

/**
 * 项目响应 DTO
 */
export interface ProjectResponseDTO {
  id: string;
  name: string;
  code: string;
  description: string;
  organizationId: string;
  organizationName: string;
  biddingType: string;
  industry: string;
  budgetAmount: number;
  currency: string;
  startDate: string;
  endDate: string;
  submissionDeadline: string;
  status: string;
  priority: string;
  winProbability: number;
  tags: string[];
  memberCount: number;
  milestoneCount: number;
  documentCount: number;
  progress: number;
  createdBy: string;
  createdByName: string;
  createdAt: string;
  updatedBy: string;
  updatedByName: string;
  updatedAt: string;
}

/**
 * 创建项目 DTO
 */
export interface CreateProjectDTO {
  name: string;
  description?: string;
  organizationId: string;
  biddingType?: string;
  industry?: string;
  budgetAmount?: number;
  currency?: string;
  startDate?: string;
  endDate?: string;
  submissionDeadline?: string;
  priority?: string;
  winProbability?: number;
  tags?: string[];
}

/**
 * 更新项目 DTO
 */
export interface UpdateProjectDTO {
  name?: string;
  description?: string;
  biddingType?: string;
  industry?: string;
  budgetAmount?: number;
  startDate?: string;
  endDate?: string;
  submissionDeadline?: string;
  status?: string;
  priority?: string;
  winProbability?: number;
  tags?: string[];
}

/**
 * 分页响应
 */
export interface PaginatedResponse<T> {
  items: T[];
  total: number;
  page: number;
  pageSize: number;
  totalPages: number;
}

/**
 * 项目服务
 */
export const projectService = {
  /**
   * 获取项目列表（分页）
   */
  async getProjects(params: ProjectQueryParams): Promise<PaginatedResponse<ProjectSimpleDTO>> {
    const response = await axios.get(`${API_BASE_URL}/api/v1/projects`, { params });
    return response.data.data;
  },

  /**
   * 根据ID获取项目详情
   */
  async getProjectById(id: string): Promise<ProjectResponseDTO> {
    const response = await axios.get(`${API_BASE_URL}/api/v1/projects/${id}`);
    return response.data.data;
  },

  /**
   * 创建项目
   */
  async createProject(data: CreateProjectDTO): Promise<ProjectResponseDTO> {
    const response = await axios.post(`${API_BASE_URL}/api/v1/projects`, data);
    return response.data.data;
  },

  /**
   * 更新项目
   */
  async updateProject(id: string, data: UpdateProjectDTO): Promise<ProjectResponseDTO> {
    const response = await axios.put(`${API_BASE_URL}/api/v1/projects/${id}`, data);
    return response.data.data;
  },

  /**
   * 删除项目（软删除）
   */
  async deleteProject(id: string): Promise<void> {
    await axios.delete(`${API_BASE_URL}/api/v1/projects/${id}`);
  },

  /**
   * 更新项目状态
   */
  async updateProjectStatus(id: string, status: string): Promise<void> {
    await axios.patch(`${API_BASE_URL}/api/v1/projects/${id}/status`, { status });
  },
};
```

---
