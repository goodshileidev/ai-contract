# Java Spring Boot 服务任务详细计划 - JAVA-001 Part3 - 1.5: 用户个人信息管理 - 1.5.1 数据定义

**验证清单**:
- [ ] DTO类定义完成
- [ ] 数据验证规则正确
- [ ] 文件上传限制配置

#### DTO类

```java
// backend-java/src/main/java/com/aibidcomposer/dto/user/UserProfileResponse.java
package com.aibidcomposer.dto.user;

import com.aibidcomposer.domain.User;
import lombok.AllArgsConstructor;
import lombok.Builder;
import lombok.Data;
import lombok.NoArgsConstructor;

import java.time.LocalDateTime;
import java.util.Set;
import java.util.UUID;
import java.util.stream.Collectors;

/**
 * 用户个人资料响应DTO
 * 需求编号: REQ-JAVA-001
 */
@Data
@Builder
@NoArgsConstructor
@AllArgsConstructor
public class UserProfileResponse {

    private UUID id;
    private String email;
    private String username;
    private String fullName;
    private String phone;
    private String avatarUrl;
    private String status;
    private Boolean emailVerified;
    private Boolean phoneVerified;
    private LocalDateTime lastLoginAt;
    private Integer loginCount;

    // 组织信息
    private UUID organizationId;
    private String organizationName;

    // 角色和权限
    private Set<String> roles;
    private Set<String> permissions;

    // 用户设置
    private Object settings;

    // 统计信息
    private Integer projectsCount;
    private Integer documentsCount;

    private LocalDateTime createdAt;
    private LocalDateTime updatedAt;

    public static UserProfileResponse from(User user) {
        return UserProfileResponse.builder()
                .id(user.getId())
                .email(user.getEmail())
                .username(user.getUsername())
                .fullName(user.getFullName())
                .phone(user.getPhone())
                .avatarUrl(user.getAvatarUrl())
                .status(user.getStatus().name())
                .emailVerified(user.getEmailVerified())
                .phoneVerified(user.getPhoneVerified())
                .lastLoginAt(user.getLastLoginAt())
                .loginCount(user.getLoginCount())
                .organizationId(user.getOrganization() != null ?
                        user.getOrganization().getId() : null)
                .organizationName(user.getOrganization() != null ?
                        user.getOrganization().getName() : null)
                .createdAt(user.getCreatedAt())
                .updatedAt(user.getUpdatedAt())
                .build();
    }
}
```

```java
// backend-java/src/main/java/com/aibidcomposer/dto/user/UpdateProfileRequest.java
package com.aibidcomposer.dto.user;

import jakarta.validation.constraints.Email;
import jakarta.validation.constraints.Size;
import lombok.Data;

/**
 * 更新个人资料请求DTO
 * 需求编号: REQ-JAVA-001
 */
@Data
public class UpdateProfileRequest {

    @Email(message = "邮箱格式不正确")
    @Size(max = 255, message = "邮箱长度不能超过255个字符")
    private String email;

    @Size(max = 200, message = "全名长度不能超过200个字符")
    private String fullName;

    @Size(max = 20, message = "手机号长度不能超过20个字符")
    private String phone;

    private Object settings;
}
```

```java
// backend-java/src/main/java/com/aibidcomposer/dto/user/ChangePasswordRequest.java
package com.aibidcomposer.dto.user;

import jakarta.validation.constraints.NotBlank;
import jakarta.validation.constraints.Size;
import lombok.Data;

/**
 * 修改密码请求DTO
 * 需求编号: REQ-JAVA-001
 */
@Data
public class ChangePasswordRequest {

    @NotBlank(message = "当前密码不能为空")
    private String oldPassword;

    @NotBlank(message = "新密码不能为空")
    @Size(min = 8, max = 100, message = "密码长度必须在8-100个字符之间")
    private String newPassword;

    @NotBlank(message = "确认密码不能为空")
    private String confirmPassword;
}
```

```java
// backend-java/src/main/java/com/aibidcomposer/dto/user/LoginHistoryResponse.java
package com.aibidcomposer.dto.user;

import lombok.AllArgsConstructor;
import lombok.Builder;
import lombok.Data;
import lombok.NoArgsConstructor;

import java.time.LocalDateTime;

/**
 * 登录历史响应DTO
 * 需求编号: REQ-JAVA-001
 */
@Data
@Builder
@NoArgsConstructor
@AllArgsConstructor
public class LoginHistoryResponse {

    private LocalDateTime loginAt;
    private String ipAddress;
    private String userAgent;
    private String location;
    private Boolean success;
}
```
