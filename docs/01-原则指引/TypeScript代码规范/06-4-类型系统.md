---
文档类型: 知识库文档
需求编号: DOC-2025-11-005
创建日期: 2025-11-26
创建者: claude-sonnet-4-5 (claude-sonnet-4-5-20250929)
最后更新: 2025-11-26
更新者: claude-sonnet-4-5 (claude-sonnet-4-5-20250929)
状态: 已批准
---

# TypeScript 代码规范 - 4. 类型系统

### 4.1 类型注解

**优先使用类型推断**：
```typescript
// ✅ 推荐：类型推断
const name = 'John';  // 推断为 string
const age = 30;       // 推断为 number

// ✅ 需要时使用类型注解
const user: User = getUserById('123');

// ❌ 不必要的类型注解
const name: string = 'John';  // ⚠️ 不必要，类型可以推断
```

**函数参数和返回值必须标注类型**：
```typescript
// ✅ 正确：参数和返回值都有类型
function getUserById(id: string): User | null {
  // ...
}

// ✅ 正确：箭头函数
const getUserById = (id: string): User | null => {
  // ...
};

// ❌ 错误：缺少类型注解
function getUserById(id) {  // ❌ 参数缺少类型
  // ...
}
```

### 4.2 接口 vs 类型别名

**优先使用接口**（可扩展）：
```typescript
// ✅ 推荐：使用 interface
interface User {
  id: string;
  name: string;
  email: string;
}

// ✅ 接口可以扩展
interface Employee extends User {
  department: string;
}

// ✅ 类型别名用于联合类型、元组等
type Status = 'active' | 'inactive';
type Point = [number, number];
type Callback = (data: string) => void;
```

### 4.3 联合类型和交叉类型

```typescript
// ✅ 联合类型（或）
type Result = User | Error;
type Status = 'success' | 'error' | 'loading';

// ✅ 交叉类型（与）
type Employee = User & {
  employeeId: string;
  department: string;
};

// ✅ 可辨识联合
type Response =
  | { status: 'success'; data: User }
  | { status: 'error'; error: string };

function handleResponse(response: Response) {
  if (response.status === 'success') {
    // TypeScript 知道这里是 success 分支
    console.log(response.data);
  } else {
    // TypeScript 知道这里是 error 分支
    console.error(response.error);
  }
}
```

### 4.4 泛型

```typescript
// ✅ 泛型函数
function first<T>(arr: T[]): T | undefined {
  return arr[0];
}

// ✅ 泛型接口
interface ApiResponse<T> {
  code: number;
  message: string;
  data: T;
}

// 使用
const userResponse: ApiResponse<User> = {
  code: 200,
  message: 'Success',
  data: { id: '1', name: 'John', email: 'john@example.com' },
};

// ✅ 泛型约束
function getProperty<T, K extends keyof T>(obj: T, key: K): T[K] {
  return obj[key];
}
```

### 4.5 类型断言

**尽量避免类型断言**：
```typescript
// ⚠️ 仅在必要时使用类型断言
const input = document.getElementById('myInput') as HTMLInputElement;

// ✅ 更好：类型守卫
function isHTMLInputElement(el: HTMLElement): el is HTMLInputElement {
  return el.tagName === 'INPUT';
}

const element = document.getElementById('myInput');
if (element && isHTMLInputElement(element)) {
  console.log(element.value);
}

// ❌ 避免：双重断言
const value = input as unknown as string;  // ❌ 危险
```

### 4.6 null 和 undefined

```typescript
// ✅ 使用 Optional 表示可能为 undefined
interface User {
  id: string;
  name: string;
  email?: string;  // email 可能为 undefined
}

// ✅ 使用 | null 表示可能为 null
function findUser(id: string): User | null {
  // 找不到返回 null
}

// ✅ 使用可选链和空值合并
const email = user?.email ?? 'no-email@example.com';

// ❌ 避免：混用 null 和 undefined
function getUser(): User | null | undefined {  // ❌ 不要混用
  // ...
}
```

---
