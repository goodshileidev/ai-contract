# Java Spring Boot 服务任务详细计划 - JAVA-001 Part1 - 1.1 用户管理基础功能 - 1.2.1 数据定义

#### Redis Token 存储结构

```bash
# Token存储格式
# Key: token:{token_hash}
# Value: {user_id, issued_at, expires_at}
# TTL: JWT_EXPIRATION (默认3600秒)

# Refresh Token存储格式
# Key: refresh_token:{token_hash}
# Value: {user_id, access_token_hash, issued_at, expires_at}
# TTL: JWT_REFRESH_EXPIRATION (默认604800秒)

# Token黑名单（用于登出）
# Key: token_blacklist:{token_hash}
# Value: {user_id, revoked_at, reason}
# TTL: 剩余有效期

# 用户活跃Token集合
# Key: user_tokens:{user_id}
# Value: Set[token_hash1, token_hash2, ...]
# TTL: 不过期，手动清理
```

#### JWT Payload 结构

```java
// JWT Token Payload 结构
{
  "sub": "user_id",                    // 主题（用户ID）
  "username": "johndoe",               // 用户名
  "email": "john@example.com",         // 邮箱
  "organizationId": "org_uuid",        // 组织ID
  "roles": ["ADMIN", "MEMBER"],        // 角色列表
  "permissions": [                      // 权限列表
    "user:read",
    "user:write",
    "project:read"
  ],
  "iat": 1700000000,                    // 签发时间
  "exp": 1700003600,                    // 过期时间
  "jti": "token_unique_id"              // Token唯一ID
}
```

**验证标准**:
- [ ] Redis 连接配置正确
- [ ] Token 数据结构设计合理
- [ ] TTL 过期机制正确
- [ ] JWT Payload 包含所有必需字段
