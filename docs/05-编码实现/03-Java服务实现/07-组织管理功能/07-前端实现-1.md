# Java Spring Boot - JAVA-002 Part1 (组织管理: 数据+前端) - JAVA-002: 组织和项目管理模块 - 2.1: 组织管理功能 - 2.1.2: 前端 - 分段1

**验证清单**:
- [ ] TypeScript 类型定义完成
- [ ] 组织列表页面（ProTable）完成
- [ ] 组织创建/编辑表单（ProForm）完成
- [ ] 组织详情页面完成
- [ ] 组织成员管理界面完成
- [ ] API 服务层完成
- [ ] 前端路由配置完成

**TypeScript 类型定义** (`types/organization.ts`):

```typescript
// apps/frontend/src/types/organization.ts
/**
 * 组织类型定义
 * 需求编号: REQ-JAVA-002
 */

export enum OrganizationType {
  COMPANY = 'COMPANY',
  GOVERNMENT = 'GOVERNMENT',
  INSTITUTION = 'INSTITUTION',
  INDIVIDUAL = 'INDIVIDUAL',
}

export enum OrganizationScale {
  SMALL = 'SMALL',
  MEDIUM = 'MEDIUM',
  LARGE = 'LARGE',
  XLARGE = 'XLARGE',
}

export enum OrganizationStatus {
  ACTIVE = 'ACTIVE',
  INACTIVE = 'INACTIVE',
  SUSPENDED = 'SUSPENDED',
}

export enum OrganizationRole {
  OWNER = 'OWNER',
  ADMIN = 'ADMIN',
  MEMBER = 'MEMBER',
  GUEST = 'GUEST',
}

export interface OrganizationSimple {
  id: string;
  name: string;
  shortName?: string;
  organizationType?: OrganizationType;
  status: OrganizationStatus;
  logoUrl?: string;
}

export interface Organization extends OrganizationSimple {
  taxId?: string;
  legalPerson?: string;
  contactPhone?: string;
  contactEmail?: string;
  address?: string;
  province?: string;
  city?: string;
  district?: string;
  website?: string;
  industry?: string;
  scale?: OrganizationScale;
  establishedDate?: string;
  parent?: OrganizationSimple;
  children?: OrganizationSimple[];
  depth?: number;
  memberCount?: number;
  createdAt: string;
  updatedAt: string;
}

export interface CreateOrganizationRequest {
  name: string;
  shortName?: string;
  organizationType?: OrganizationType;
  taxId?: string;
  legalPerson?: string;
  contactPhone?: string;
  contactEmail?: string;
  address?: string;
  province?: string;
  city?: string;
  district?: string;
  logoUrl?: string;
  website?: string;
  industry?: string;
  scale?: OrganizationScale;
  establishedDate?: string;
  parentId?: string;
}

export interface UpdateOrganizationRequest {
  name?: string;
  shortName?: string;
  organizationType?: OrganizationType;
  taxId?: string;
  legalPerson?: string;
  contactPhone?: string;
  contactEmail?: string;
  address?: string;
  province?: string;
  city?: string;
  district?: string;
  logoUrl?: string;
  website?: string;
  industry?: string;
  scale?: OrganizationScale;
  establishedDate?: string;
  status?: OrganizationStatus;
}

export interface OrganizationMember {
  id: string;
  userId: string;
  username?: string;
  fullName?: string;
  email?: string;
  avatarUrl?: string;
  role: OrganizationRole;
  joinedAt: string;
}

export interface AddMemberRequest {
  userId: string;
  role: OrganizationRole;
}
```

**API 服务层** (`services/organization.service.ts`):

```typescript
// apps/frontend/src/services/organization.service.ts
/**
 * 组织管理API服务
 * 需求编号: REQ-JAVA-002
 */

import { request } from '@umijs/max';
import type {
  Organization,
  CreateOrganizationRequest,
  UpdateOrganizationRequest,
  OrganizationMember,
  AddMemberRequest,
} from '@/types/organization';

const API_BASE = '/api/v1/organizations';

export const organizationService = {
  /**
   * 获取组织列表
   */
  async getList(params: {
    page?: number;
    pageSize?: number;
    search?: string;
    status?: string;
  }) {
    return request<{
      success: boolean;
      data: {
        items: Organization[];
        total: number;
        page: number;
        pageSize: number;
        totalPages: number;
      };
    }>(`${API_BASE}`, {
      method: 'GET',
      params,
    });
  },

  /**
   * 获取组织详情
   */
  async getById(id: string) {
    return request<{
      success: boolean;
      data: Organization;
    }>(`${API_BASE}/${id}`, {
      method: 'GET',
    });
  },

  /**
   * 创建组织
   */
  async create(data: CreateOrganizationRequest) {
    return request<{
      success: boolean;
      data: Organization;
      message: string;
    }>(`${API_BASE}`, {
      method: 'POST',
      data,
    });
  },

  /**
   * 更新组织
   */
  async update(id: string, data: UpdateOrganizationRequest) {
    return request<{
      success: boolean;
      data: Organization;
      message: string;
    }>(`${API_BASE}/${id}`, {
      method: 'PUT',
      data,
    });
  },

  /**
   * 删除组织
   */
  async delete(id: string) {
    return request<{
      success: boolean;
      message: string;
    }>(`${API_BASE}/${id}`, {
      method: 'DELETE',
    });
  },

  /**
   * 获取组织成员列表
   */
  async getMembers(organizationId: string) {
    return request<{
      success: boolean;
      data: OrganizationMember[];
    }>(`${API_BASE}/${organizationId}/members`, {
      method: 'GET',
    });
  },

  /**
   * 添加组织成员
   */
  async addMember(organizationId: string, data: AddMemberRequest) {
    return request<{
      success: boolean;
      data: OrganizationMember;
      message: string;
    }>(`${API_BASE}/${organizationId}/members`, {
      method: 'POST',
      data,
    });
  },

  /**
   * 移除组织成员
   */
  async removeMember(organizationId: string, memberId: string) {
    return request<{
      success: boolean;
      message: string;
    }>(`${API_BASE}/${organizationId}/members/${memberId}`, {
      method: 'DELETE',
    });
  },

  /**
   * 更新成员角色
   */
  async updateMemberRole(
    organizationId: string,
    memberId: string,
    role: string
  ) {
    return request<{
      success: boolean;
      data: OrganizationMember;
      message: string;
    }>(`${API_BASE}/${organizationId}/members/${memberId}/role`, {
      method: 'PUT',
      data: { role },
    });
  },
};
```

**组织列表页面** (`pages/Organization/List.tsx`):

```typescript
// apps/frontend/src/pages/Organization/List.tsx
/**
 * 组织列表页面
 * 需求编号: REQ-JAVA-002
 */

import { PlusOutlined } from '@ant-design/icons';
import { ProTable } from '@ant-design/pro-components';
import { Button, message, Tag } from 'antd';
import { useNavigate } from '@umijs/max';
import { organizationService } from '@/services/organization.service';
import type { Organization, OrganizationStatus } from '@/types/organization';

const statusColorMap: Record<OrganizationStatus, string> = {
  ACTIVE: 'green',
  INACTIVE: 'gray',
  SUSPENDED: 'red',
};

const statusTextMap: Record<OrganizationStatus, string> = {
  ACTIVE: '活跃',
  INACTIVE: '未激活',
  SUSPENDED: '已暂停',
};

const OrganizationListPage: React.FC = () => {
  const navigate = useNavigate();

  const columns = [
    {
      title: '组织名称',
      dataIndex: 'name',
      key: 'name',
      render: (_: any, record: Organization) => (
        <a onClick={() => navigate(`/organizations/${record.id}`)}>
          {record.name}
        </a>
      ),
    },
    {
      title: '组织简称',
      dataIndex: 'shortName',
      key: 'shortName',
      hideInSearch: true,
    },
    {
      title: '组织类型',
      dataIndex: 'organizationType',
      key: 'organizationType',
      valueEnum: {
        COMPANY: { text: '公司' },
        GOVERNMENT: { text: '政府机构' },
        INSTITUTION: { text: '事业单位' },
        INDIVIDUAL: { text: '个人' },
      },
    },
    {
      title: '成员数量',
      dataIndex: 'memberCount',
      key: 'memberCount',
      hideInSearch: true,
    },
    {
      title: '状态',
      dataIndex: 'status',
      key: 'status',
      render: (status: OrganizationStatus) => (
        <Tag color={statusColorMap[status]}>
          {statusTextMap[status]}
        </Tag>
      ),
      valueEnum: {
        ACTIVE: { text: '活跃', status: 'Success' },
        INACTIVE: { text: '未激活', status: 'Default' },
        SUSPENDED: { text: '已暂停', status: 'Error' },
      },
    },
    {
      title: '创建时间',
      dataIndex: 'createdAt',
      key: 'createdAt',
      valueType: 'dateTime',
      hideInSearch: true,
    },
    {
      title: '操作',
      key: 'action',
      valueType: 'option',
      render: (_: any, record: Organization) => [
        <a key="view" onClick={() => navigate(`/organizations/${record.id}`)}>
          查看
        </a>,
        <a
          key="edit"
          onClick={() => navigate(`/organizations/${record.id}/edit`)}
        >
          编辑
        </a>,
        <a
          key="delete"
          onClick={async () => {
            try {
              await organizationService.delete(record.id);
              message.success('删除成功');
              // 刷新列表
            } catch (error) {
              message.error('删除失败');
            }
          }}
        >
          删除
        </a>,
      ],
    },
  ];

  return (
    <ProTable<Organization>
      headerTitle="组织列表"
      rowKey="id"
      request={async (params) => {
        const response = await organizationService.getList({
          page: params.current,
          pageSize: params.pageSize,
          search: params.name,
          status: params.status,
        });

        return {
          data: response.data.items,
          success: response.success,
          total: response.data.total,
        };
      }}
      columns={columns}
      toolBarRender={() => [
        <Button
          key="create"
          type="primary"
          icon={<PlusOutlined />}
          onClick={() => navigate('/organizations/create')}
        >
          新建组织
        </Button>,
      ]}
      search={{
        labelWidth: 'auto',
      }}
      pagination={{
        pageSize: 20,
        showSizeChanger: true,
      }}
    />
  );
};

export default OrganizationListPage;
```

**组织表单页面** (`pages/Organization/Form.tsx`):

```typescript
// apps/frontend/src/pages/Organization/Form.tsx
/**
 * 组织创建/编辑表单
 * 需求编号: REQ-JAVA-002
 */

import { ProForm, ProFormText, ProFormSelect, ProFormDatePicker } from '@ant-design/pro-components';
import { Card, message } from 'antd';
import { useNavigate, useParams } from '@umijs/max';
import { useEffect } from 'react';
import { organizationService } from '@/services/organization.service';
import type { Organization } from '@/types/organization';

const OrganizationFormPage: React.FC = () => {
  const navigate = useNavigate();
  const { id } = useParams<{ id: string }>();
  const isEdit = !!id;

  const [form] = ProForm.useForm();

  useEffect(() => {
    if (isEdit && id) {
      organizationService.getById(id).then((res) => {
        if (res.success) {
          form.setFieldsValue(res.data);
        }
      });
    }
  }, [id, isEdit, form]);

  const handleSubmit = async (values: Organization) => {
    try {
      if (isEdit && id) {
        await organizationService.update(id, values);
        message.success('更新成功');
      } else {
        await organizationService.create(values);
        message.success('创建成功');
      }
      navigate('/organizations');
    } catch (error) {
      message.error(isEdit ? '更新失败' : '创建失败');
    }
  };

  return (
    <Card title={isEdit ? '编辑组织' : '新建组织'}>
      <ProForm
        form={form}
        onFinish={handleSubmit}
        submitter={{
          searchConfig: {
            resetText: '取消',
            submitText: isEdit ? '更新' : '创建',
          },
          resetButtonProps: {
            onClick: () => navigate('/organizations'),
          },
        }}
      >
        <ProFormText
          name="name"
          label="组织名称"
          placeholder="请输入组织名称"
          rules={[
            { required: true, message: '请输入组织名称' },
            { max: 200, message: '组织名称最多200个字符' },
          ]}
        />

        <ProFormText
          name="shortName"
          label="组织简称"
          placeholder="请输入组织简称"
          rules={[{ max: 100, message: '组织简称最多100个字符' }]}
        />

        <ProFormSelect
          name="organizationType"
          label="组织类型"
          valueEnum={{
            COMPANY: '公司',
            GOVERNMENT: '政府机构',
            INSTITUTION: '事业单位',
            INDIVIDUAL: '个人',
          }}
          placeholder="请选择组织类型"
        />

        <ProFormText
          name="taxId"
          label="统一社会信用代码"
          placeholder="请输入18位统一社会信用代码"
          rules={[
            {
              pattern: /^[A-Z0-9]{18}$/,
              message: '请输入18位统一社会信用代码',
            },
          ]}
        />

        <ProFormText
          name="legalPerson"
          label="法定代表人"
          placeholder="请输入法定代表人"
          rules={[{ max: 100, message: '法定代表人最多100个字符' }]}
        />

        <ProFormText
          name="contactPhone"
          label="联系电话"
          placeholder="请输入联系电话"
          rules={[
            {
              pattern: /^1[3-9]\d{9}$/,
              message: '请输入正确的手机号码',
            },
          ]}
        />

        <ProFormText
          name="contactEmail"
          label="联系邮箱"
          placeholder="请输入联系邮箱"
          rules={[{ type: 'email', message: '请输入正确的邮箱地址' }]}
        />

        <ProFormText
          name="province"
          label="省份"
          placeholder="请输入省份"
        />

        <ProFormText
          name="city"
          label="城市"
          placeholder="请输入城市"
        />

        <ProFormText
          name="district"
          label="区县"
          placeholder="请输入区县"
        />

        <ProFormText
          name="address"
          label="详细地址"
          placeholder="请输入详细地址"
        />

        <ProFormText
          name="website"
          label="官方网站"
          placeholder="请输入官方网站"
        />

        <ProFormText
          name="industry"
          label="所属行业"
          placeholder="请输入所属行业"
          rules={[{ max: 100, message: '所属行业最多100个字符' }]}
        />

        <ProFormSelect
          name="scale"
          label="企业规模"
          valueEnum={{
            SMALL: '小型（<100人）',
            MEDIUM: '中型（100-500人）',
            LARGE: '大型（500-5000人）',
            XLARGE: '超大型（>5000人）',
          }}
          placeholder="请选择企业规模"
        />

        <ProFormDatePicker
          name="establishedDate"
          label="成立日期"
          placeholder="请选择成立日期"
        />

        {isEdit && (
          <ProFormSelect
            name="status"
            label="状态"
            valueEnum={{
              ACTIVE: '活跃',
              INACTIVE: '未激活',
              SUSPENDED: '已暂停',
            }}
            placeholder="请选择状态"
          />
        )}
      </ProForm>
    </Card>
  );
};

export default OrganizationFormPage;
```

**组织详情页面** (`pages/Organization/Detail.tsx`):

```typescript
// apps/frontend/src/pages/Organization/Detail.tsx
/**
 * 组织详情页面
 * 需求编号: REQ-JAVA-002
 */

import { ProDescriptions } from '@ant-design/pro-components';
import { Card, Button, Tabs, message } from 'antd';
import { useNavigate, useParams } from '@umijs/max';
import { useEffect, useState } from 'react';
import { organizationService } from '@/services/organization.service';
import type { Organization } from '@/types/organization';
import OrganizationMemberList from './components/MemberList';

const OrganizationDetailPage: React.FC = () => {
  const navigate = useNavigate();
  const { id } = useParams<{ id: string }>();
  const [organization, setOrganization] = useState<Organization | null>(null);
  const [loading, setLoading] = useState(false);

  useEffect(() => {
    if (id) {
      loadOrganization();
    }
  }, [id]);

  const loadOrganization = async () => {
    if (!id) return;

    setLoading(true);
    try {
      const res = await organizationService.getById(id);
      if (res.success) {
        setOrganization(res.data);
      }
    } catch (error) {
      message.error('加载失败');
    } finally {
      setLoading(false);
    }
  };

  if (!organization) {
    return <div>加载中...</div>;
  }

  return (
    <Card
      title={organization.name}
      extra={
        <Button type="primary" onClick={() => navigate(`/organizations/${id}/edit`)}>
          编辑
        </Button>
      }
      loading={loading}
    >
      <Tabs
        items={[
          {
            key: 'info',
            label: '基本信息',
            children: (
              <ProDescriptions
                column={2}
                dataSource={organization}
                columns={[
                  { title: '组织名称', dataIndex: 'name' },
                  { title: '组织简称', dataIndex: 'shortName' },
                  { title: '组织类型', dataIndex: 'organizationType' },
                  { title: '统一社会信用代码', dataIndex: 'taxId' },
                  { title: '法定代表人', dataIndex: 'legalPerson' },
                  { title: '联系电话', dataIndex: 'contactPhone' },
                  { title: '联系邮箱', dataIndex: 'contactEmail' },
                  { title: '省份', dataIndex: 'province' },
                  { title: '城市', dataIndex: 'city' },
                  { title: '区县', dataIndex: 'district' },
                  { title: '详细地址', dataIndex: 'address', span: 2 },
                  { title: '官方网站', dataIndex: 'website' },
                  { title: '所属行业', dataIndex: 'industry' },
                  { title: '企业规模', dataIndex: 'scale' },
                  { title: '成立日期', dataIndex: 'establishedDate', valueType: 'date' },
                  { title: '状态', dataIndex: 'status' },
                  { title: '成员数量', dataIndex: 'memberCount' },
                  { title: '创建时间', dataIndex: 'createdAt', valueType: 'dateTime' },
                  { title: '更新时间', dataIndex: 'updatedAt', valueType: 'dateTime' },
                ]}
              />
            ),
          },
          {
            key: 'members',
            label: '成员管理',
            children: <OrganizationMemberList organizationId={id!} />,
          },
        ]}
      />
    </Card>
  );
};

export default OrganizationDetailPage;
```

**组织成员管理组件** (`pages/Organization/components/MemberList.tsx`):

```typescript
// apps/frontend/src/pages/Organization/components/MemberList.tsx
/**
 * 组织成员管理组件
 * 需求编号: REQ-JAVA-002
 */

import { ProTable } from '@ant-design/pro-components';
import { Button, message, Modal, Form, Select } from 'antd';
import { PlusOutlined } from '@ant-design/icons';
import { useState } from 'react';
import { organizationService } from '@/services/organization.service';
import type { OrganizationMember, OrganizationRole } from '@/types/organization';

interface MemberListProps {
  organizationId: string;
}

const OrganizationMemberList: React.FC<MemberListProps> = ({ organizationId }) => {
  const [addModalVisible, setAddModalVisible] = useState(false);
  const [form] = Form.useForm();

  const columns = [
    {
      title: '用户名',
      dataIndex: 'username',
      key: 'username',
    },
    {
      title: '姓名',
      dataIndex: 'fullName',
      key: 'fullName',
    },
    {
      title: '邮箱',
      dataIndex: 'email',
      key: 'email',
    },
    {
      title: '角色',
      dataIndex: 'role',
      key: 'role',
      valueEnum: {
        OWNER: { text: '所有者', status: 'Success' },
        ADMIN: { text: '管理员', status: 'Processing' },
        MEMBER: { text: '普通成员', status: 'Default' },
        GUEST: { text: '访客', status: 'Default' },
      },
    },
    {
      title: '加入时间',
      dataIndex: 'joinedAt',
      key: 'joinedAt',
      valueType: 'dateTime',
    },
    {
      title: '操作',
      key: 'action',
      valueType: 'option',
      render: (_: any, record: OrganizationMember) => [
        <a
          key="remove"
          onClick={async () => {
            try {
              await organizationService.removeMember(organizationId, record.id);
              message.success('移除成功');
              // 刷新列表
            } catch (error) {
              message.error('移除失败');
            }
          }}
        >
          移除
        </a>,
      ],
    },
  ];

  const handleAddMember = async (values: { userId: string; role: OrganizationRole }) => {
    try {
      await organizationService.addMember(organizationId, values);
      message.success('添加成功');
      setAddModalVisible(false);
      form.resetFields();
      // 刷新列表
    } catch (error) {
      message.error('添加失败');
    }
