# Java Spring Boot - JAVA-002 Part1 (ç»„ç»‡ç®¡ç†: æ•°æ®+å‰ç«¯) - JAVA-002: ç»„ç»‡å’Œé¡¹ç›®ç®¡ç†æ¨¡å— - 2.2.3: Javaåç«¯ - 2.2.5 éƒ¨ç½²

> **ç›®æ ‡**: ç¡®ä¿é¡¹ç›®ç®¡ç†åŠŸèƒ½åœ¨Dockerå’ŒKubernetesç¯å¢ƒä¸­æ­£ç¡®éƒ¨ç½²å’Œè¿è¡Œ

##### éªŒè¯æ¸…å•

**éªŒè¯æ¸…å•**:
- [ ] Docker Composeé…ç½®æ›´æ–°å®Œæˆ
- [ ] Kubernetesèµ„æºæ¸…å•æ›´æ–°å®Œæˆ
- [ ] æœåŠ¡é—´ç½‘ç»œé€šä¿¡é…ç½®å®Œæˆ
- [ ] ç¯å¢ƒå˜é‡é…ç½®å®Œæˆ
- [ ] å¥åº·æ£€æŸ¥é…ç½®å®Œæˆ
- [ ] éƒ¨ç½²è„šæœ¬æ›´æ–°å®Œæˆ
- [ ] æœ¬åœ°ç¯å¢ƒæµ‹è¯•é€šè¿‡
- [ ] Kubernetesç¯å¢ƒæµ‹è¯•é€šè¿‡

##### Docker Composeé…ç½®

**1. å®Œæ•´çš„docker-compose.ymlæ›´æ–°**

```yaml
# docker-compose.yml
version: '3.8'

services:
  # PostgreSQLæ•°æ®åº“
  postgres:
    image: postgres:14-alpine
    container_name: aibidcomposer-postgres
    environment:
      POSTGRES_DB: aibidcomposer
      POSTGRES_USER: postgres
      POSTGRES_PASSWORD: ${POSTGRES_PASSWORD:-postgres}
      TZ: Asia/Shanghai
    ports:
      - "5432:5432"
    volumes:
      - postgres_data:/var/lib/postgresql/data
      - ./docker/postgres/init.sql:/docker-entrypoint-initdb.d/init.sql
    healthcheck:
      test: ["CMD-SHELL", "pg_isready -U postgres"]
      interval: 10s
      timeout: 5s
      retries: 5
    networks:
      - aibidcomposer-network

  # Redisç¼“å­˜
  redis:
    image: redis:7-alpine
    container_name: aibidcomposer-redis
    command: redis-server --appendonly yes --requirepass ${REDIS_PASSWORD:-redis}
    ports:
      - "6379:6379"
    volumes:
      - redis_data:/data
    healthcheck:
      test: ["CMD", "redis-cli", "ping"]
      interval: 10s
      timeout: 3s
      retries: 5
    networks:
      - aibidcomposer-network

  # Elasticsearchï¼ˆå‘é‡å­˜å‚¨ï¼‰
  elasticsearch:
    image: docker.elastic.co/elasticsearch/elasticsearch:8.11.0
    container_name: aibidcomposer-elasticsearch
    environment:
      - discovery.type=single-node
      - xpack.security.enabled=true
      - ELASTIC_PASSWORD=${ELASTICSEARCH_PASSWORD:-elastic}
      - "ES_JAVA_OPTS=-Xms2g -Xmx2g"
    ports:
      - "9200:9200"
    volumes:
      - elasticsearch_data:/usr/share/elasticsearch/data
    healthcheck:
      test: ["CMD-SHELL", "curl -u elastic:${ELASTICSEARCH_PASSWORD:-elastic} -f http://localhost:9200/_cluster/health || exit 1"]
      interval: 30s
      timeout: 10s
      retries: 5
    networks:
      - aibidcomposer-network

  # RabbitMQæ¶ˆæ¯é˜Ÿåˆ—
  rabbitmq:
    image: rabbitmq:3-management-alpine
    container_name: aibidcomposer-rabbitmq
    environment:
      RABBITMQ_DEFAULT_USER: ${RABBITMQ_USER:-rabbitmq}
      RABBITMQ_DEFAULT_PASS: ${RABBITMQ_PASSWORD:-rabbitmq}
    ports:
      - "5672:5672"
      - "15672:15672"
    volumes:
      - rabbitmq_data:/var/lib/rabbitmq
    healthcheck:
      test: ["CMD", "rabbitmq-diagnostics", "ping"]
      interval: 30s
      timeout: 10s
      retries: 5
    networks:
      - aibidcomposer-network

  # MinIOå¯¹è±¡å­˜å‚¨
  minio:
    image: minio/minio:latest
    container_name: aibidcomposer-minio
    command: server /data --console-address ":9001"
    environment:
      MINIO_ROOT_USER: ${MINIO_ROOT_USER:-minioadmin}
      MINIO_ROOT_PASSWORD: ${MINIO_ROOT_PASSWORD:-minioadmin}
    ports:
      - "9000:9000"
      - "9001:9001"
    volumes:
      - minio_data:/data
    healthcheck:
      test: ["CMD", "curl", "-f", "http://localhost:9000/minio/health/live"]
      interval: 30s
      timeout: 20s
      retries: 3
    networks:
      - aibidcomposer-network

  # Java Spring BootæœåŠ¡ï¼ˆæ ¸å¿ƒä¸šåŠ¡ï¼‰
  backend-java:
    build:
      context: ./apps/backend-java
      dockerfile: Dockerfile.dev
    container_name: aibidcomposer-backend-java
    environment:
      # Springé…ç½®
      SPRING_PROFILES_ACTIVE: dev
      SPRING_DATASOURCE_URL: jdbc:postgresql://postgres:5432/aibidcomposer
      SPRING_DATASOURCE_USERNAME: postgres
      SPRING_DATASOURCE_PASSWORD: ${POSTGRES_PASSWORD:-postgres}

      # Redisé…ç½®
      SPRING_REDIS_HOST: redis
      SPRING_REDIS_PASSWORD: ${REDIS_PASSWORD:-redis}

      # RabbitMQé…ç½®
      SPRING_RABBITMQ_HOST: rabbitmq
      SPRING_RABBITMQ_USERNAME: ${RABBITMQ_USER:-rabbitmq}
      SPRING_RABBITMQ_PASSWORD: ${RABBITMQ_PASSWORD:-rabbitmq}

      # MinIOé…ç½®
      MINIO_ENDPOINT: http://minio:9000
      MINIO_ACCESS_KEY: ${MINIO_ROOT_USER:-minioadmin}
      MINIO_SECRET_KEY: ${MINIO_ROOT_PASSWORD:-minioadmin}

      # Python AIæœåŠ¡URL
      AI_SERVICE_URL: http://backend-python:8001

      # JWTå¯†é’¥
      JWT_SECRET: ${SECRET_KEY}
      JWT_EXPIRATION: 3600000
    ports:
      - "8080:8080"
    depends_on:
      postgres:
        condition: service_healthy
      redis:
        condition: service_healthy
      rabbitmq:
        condition: service_healthy
    healthcheck:
      test: ["CMD", "curl", "-f", "http://localhost:8080/actuator/health"]
      interval: 30s
      timeout: 10s
      retries: 3
      start_period: 60s
    volumes:
      - ./apps/backend-java/src:/app/src
      - ./apps/backend-java/target:/app/target
    networks:
      - aibidcomposer-network

  # Python FastAPI AIæœåŠ¡
  backend-python:
    build:
      context: ./apps/backend-python
      dockerfile: Dockerfile
    container_name: aibidcomposer-backend-python
    environment:
      # Redisé…ç½®
      REDIS_URL: redis://:${REDIS_PASSWORD:-redis}@redis:6379/0

      # RabbitMQé…ç½®
      RABBITMQ_URL: amqp://${RABBITMQ_USER:-rabbitmq}:${RABBITMQ_PASSWORD:-rabbitmq}@rabbitmq:5672/

      # Elasticsearché…ç½®
      ELASTICSEARCH_URL: http://elasticsearch:9200
      ELASTICSEARCH_USER: elastic
      ELASTICSEARCH_PASSWORD: ${ELASTICSEARCH_PASSWORD:-elastic}

      # JavaæœåŠ¡URLï¼ˆæ–°å¢ï¼‰
      JAVA_SERVICE_URL: http://backend-java:8080
      JAVA_SERVICE_TIMEOUT: 30

      # AI APIå¯†é’¥
      OPENAI_API_KEY: ${OPENAI_API_KEY}
      ANTHROPIC_API_KEY: ${ANTHROPIC_API_KEY}
    ports:
      - "8001:8001"
    depends_on:
      - redis
      - rabbitmq
      - elasticsearch
      - backend-java  # ç¡®ä¿JavaæœåŠ¡å…ˆå¯åŠ¨
    healthcheck:
      test: ["CMD", "curl", "-f", "http://localhost:8001/health"]
      interval: 30s
      timeout: 10s
      retries: 3
      start_period: 30s
    volumes:
      - ./apps/backend-python/app:/app/app
    networks:
      - aibidcomposer-network
    command: uvicorn app.main:app --host 0.0.0.0 --port 8001 --reload

  # Python AI Worker (Celery)
  ai-worker:
    build:
      context: ./apps/backend-python
      dockerfile: Dockerfile
    container_name: aibidcomposer-ai-worker
    environment:
      REDIS_URL: redis://:${REDIS_PASSWORD:-redis}@redis:6379/0
      RABBITMQ_URL: amqp://${RABBITMQ_USER:-rabbitmq}:${RABBITMQ_PASSWORD:-rabbitmq}@rabbitmq:5672/
      ELASTICSEARCH_URL: http://elasticsearch:9200
      ELASTICSEARCH_PASSWORD: ${ELASTICSEARCH_PASSWORD:-elastic}
      JAVA_SERVICE_URL: http://backend-java:8080
      OPENAI_API_KEY: ${OPENAI_API_KEY}
    depends_on:
      - redis
      - rabbitmq
      - elasticsearch
      - backend-java
    networks:
      - aibidcomposer-network
    command: celery -A app.tasks.celery_app worker --loglevel=info -Q ai_tasks

  # å‰ç«¯åº”ç”¨
  frontend:
    build:
      context: ./apps/frontend
      dockerfile: Dockerfile.dev
    container_name: aibidcomposer-frontend
    ports:
      - "5173:5173"
    volumes:
      - ./apps/frontend/src:/app/src
      - ./apps/frontend/public:/app/public
    environment:
      VITE_API_BASE_URL: http://localhost:8080
      VITE_AI_API_BASE_URL: http://localhost:8001
      VITE_WS_BASE_URL: ws://localhost:8080
    networks:
      - aibidcomposer-network
    command: npm run dev

volumes:
  postgres_data:
  redis_data:
  elasticsearch_data:
  rabbitmq_data:
  minio_data:

networks:
  aibidcomposer-network:
    driver: bridge
```

##### Kubernetesé…ç½®

**1. JavaæœåŠ¡Deploymentæ›´æ–°**

```yaml
# k8s/deployments/backend-java-deployment.yaml
apiVersion: apps/v1
kind: Deployment
metadata:
  name: backend-java
  namespace: aibidcomposer
  labels:
    app: backend-java
    version: v1
spec:
  replicas: 3
  selector:
    matchLabels:
      app: backend-java
  template:
    metadata:
      labels:
        app: backend-java
        version: v1
    spec:
      containers:
      - name: backend-java
        image: aibidcomposer/backend-java:latest
        imagePullPolicy: Always
        ports:
        - containerPort: 8080
          name: http
        env:
        - name: SPRING_PROFILES_ACTIVE
          value: "prod"
        - name: SPRING_DATASOURCE_URL
          value: "jdbc:postgresql://postgres-service:5432/aibidcomposer"
        - name: SPRING_DATASOURCE_USERNAME
          value: "postgres"
        - name: SPRING_DATASOURCE_PASSWORD
          valueFrom:
            secretKeyRef:
              name: database-secret
              key: POSTGRES_PASSWORD
        - name: SPRING_REDIS_HOST
          value: "redis-service"
        - name: SPRING_REDIS_PASSWORD
          valueFrom:
            secretKeyRef:
              name: redis-secret
              key: REDIS_PASSWORD
        - name: SPRING_RABBITMQ_HOST
          value: "rabbitmq-service"
        - name: SPRING_RABBITMQ_USERNAME
          valueFrom:
            secretKeyRef:
              name: rabbitmq-secret
              key: RABBITMQ_USER
        - name: SPRING_RABBITMQ_PASSWORD
          valueFrom:
            secretKeyRef:
              name: rabbitmq-secret
              key: RABBITMQ_PASSWORD
        - name: AI_SERVICE_URL
          value: "http://backend-python-service:8001"
        - name: JWT_SECRET
          valueFrom:
            secretKeyRef:
              name: jwt-secret
              key: JWT_SECRET
        resources:
          requests:
            memory: "1Gi"
            cpu: "500m"
          limits:
            memory: "2Gi"
            cpu: "1000m"
        livenessProbe:
          httpGet:
            path: /actuator/health/liveness
            port: 8080
          initialDelaySeconds: 60
          periodSeconds: 10
          timeoutSeconds: 5
          failureThreshold: 3
        readinessProbe:
          httpGet:
            path: /actuator/health/readiness
            port: 8080
          initialDelaySeconds: 30
          periodSeconds: 5
          timeoutSeconds: 3
          failureThreshold: 3
---
apiVersion: v1
kind: Service
metadata:
  name: backend-java-service
  namespace: aibidcomposer
spec:
  selector:
    app: backend-java
  ports:
  - protocol: TCP
    port: 8080
    targetPort: 8080
  type: ClusterIP
```

**2. PythonæœåŠ¡Deploymentæ›´æ–°**

```yaml
# k8s/deployments/backend-python-deployment.yaml
apiVersion: apps/v1
kind: Deployment
metadata:
  name: backend-python
  namespace: aibidcomposer
  labels:
    app: backend-python
    version: v1
spec:
  replicas: 2
  selector:
    matchLabels:
      app: backend-python
  template:
    metadata:
      labels:
        app: backend-python
        version: v1
    spec:
      containers:
      - name: backend-python
        image: aibidcomposer/backend-python:latest
        imagePullPolicy: Always
        ports:
        - containerPort: 8001
          name: http
        env:
        - name: REDIS_URL
          valueFrom:
            secretKeyRef:
              name: redis-secret
              key: REDIS_URL
        - name: RABBITMQ_URL
          valueFrom:
            secretKeyRef:
              name: rabbitmq-secret
              key: RABBITMQ_URL
        - name: ELASTICSEARCH_URL
          value: "http://elasticsearch-service:9200"
        - name: ELASTICSEARCH_USER
          value: "elastic"
        - name: ELASTICSEARCH_PASSWORD
          valueFrom:
            secretKeyRef:
              name: elasticsearch-secret
              key: ELASTIC_PASSWORD
        - name: JAVA_SERVICE_URL
          value: "http://backend-java-service:8080"
        - name: JAVA_SERVICE_TIMEOUT
          value: "30"
        - name: OPENAI_API_KEY
          valueFrom:
            secretKeyRef:
              name: api-keys-secret
              key: OPENAI_API_KEY
        - name: ANTHROPIC_API_KEY
          valueFrom:
            secretKeyRef:
              name: api-keys-secret
              key: ANTHROPIC_API_KEY
        resources:
          requests:
            memory: "2Gi"
            cpu: "1000m"
          limits:
            memory: "4Gi"
            cpu: "2000m"
        livenessProbe:
          httpGet:
            path: /health
            port: 8001
          initialDelaySeconds: 30
          periodSeconds: 10
          timeoutSeconds: 5
        readinessProbe:
          httpGet:
            path: /health
            port: 8001
          initialDelaySeconds: 10
          periodSeconds: 5
          timeoutSeconds: 3
---
apiVersion: v1
kind: Service
metadata:
  name: backend-python-service
  namespace: aibidcomposer
spec:
  selector:
    app: backend-python
  ports:
  - protocol: TCP
    port: 8001
    targetPort: 8001
  type: ClusterIP
```

**3. Secretsé…ç½®**

```yaml
# k8s/secrets/jwt-secret.yaml
apiVersion: v1
kind: Secret
metadata:
  name: jwt-secret
  namespace: aibidcomposer
type: Opaque
stringData:
  JWT_SECRET: "your-jwt-secret-key-min-32-characters"
```

**4. NetworkPolicyï¼ˆæœåŠ¡é—´é€šä¿¡é™åˆ¶ï¼‰**

```yaml
# k8s/network-policies/backend-network-policy.yaml
apiVersion: networking.k8s.io/v1
kind: NetworkPolicy
metadata:
  name: backend-network-policy
  namespace: aibidcomposer
spec:
  podSelector:
    matchLabels:
      app: backend-python
  policyTypes:
  - Egress
  egress:
  # å…è®¸è®¿é—®JavaæœåŠ¡
  - to:
    - podSelector:
        matchLabels:
          app: backend-java
    ports:
    - protocol: TCP
      port: 8080
  # å…è®¸è®¿é—®Elasticsearch
  - to:
    - podSelector:
        matchLabels:
          app: elasticsearch
    ports:
    - protocol: TCP
      port: 9200
  # å…è®¸è®¿é—®Redis
  - to:
    - podSelector:
        matchLabels:
          app: redis
    ports:
    - protocol: TCP
      port: 6379
  # å…è®¸è®¿é—®RabbitMQ
  - to:
    - podSelector:
        matchLabels:
          app: rabbitmq
    ports:
    - protocol: TCP
      port: 5672
  # å…è®¸DNSæŸ¥è¯¢
  - to:
    - namespaceSelector:
        matchLabels:
          name: kube-system
    ports:
    - protocol: UDP
      port: 53
```

##### éƒ¨ç½²è„šæœ¬

**1. æœ¬åœ°ç¯å¢ƒå¯åŠ¨è„šæœ¬**

```bash
#!/bin/bash
# scripts/start-dev.sh
# æœ¬åœ°å¼€å‘ç¯å¢ƒå¯åŠ¨è„šæœ¬

set -e

echo "========================================="
echo "å¯åŠ¨ AIBidComposer æœ¬åœ°å¼€å‘ç¯å¢ƒ"
echo "========================================="

# æ£€æŸ¥Dockeræ˜¯å¦è¿è¡Œ
if ! docker info > /dev/null 2>&1; then
  echo "âŒ Dockeræœªè¿è¡Œï¼Œè¯·å…ˆå¯åŠ¨Docker"
  exit 1
fi

# æ£€æŸ¥.envæ–‡ä»¶
if [ ! -f .env ]; then
  echo "âš ï¸  .envæ–‡ä»¶ä¸å­˜åœ¨ï¼Œä».env.exampleåˆ›å»º"
  cp .env.example .env
  echo "âœ… è¯·ç¼–è¾‘.envæ–‡ä»¶ï¼Œå¡«å†™å¿…è¦çš„é…ç½®é¡¹ï¼ˆå¦‚APIå¯†é’¥ï¼‰"
  exit 1
fi

# å¯åŠ¨æ‰€æœ‰æœåŠ¡
echo "ğŸš€ å¯åŠ¨æ‰€æœ‰æœåŠ¡..."
docker-compose up -d

# ç­‰å¾…æœåŠ¡å°±ç»ª
echo "â³ ç­‰å¾…æœåŠ¡å°±ç»ª..."

# ç­‰å¾…PostgreSQL
echo "   - ç­‰å¾…PostgreSQL..."
until docker-compose exec -T postgres pg_isready -U postgres > /dev/null 2>&1; do
  sleep 1
done
echo "   âœ… PostgreSQLå°±ç»ª"

# ç­‰å¾…JavaæœåŠ¡
echo "   - ç­‰å¾…JavaæœåŠ¡..."
until curl -f http://localhost:8080/actuator/health > /dev/null 2>&1; do
  sleep 2
done
echo "   âœ… JavaæœåŠ¡å°±ç»ª"

# ç­‰å¾…PythonæœåŠ¡
echo "   - ç­‰å¾…PythonæœåŠ¡..."
until curl -f http://localhost:8001/health > /dev/null 2>&1; do
  sleep 2
done
echo "   âœ… PythonæœåŠ¡å°±ç»ª"

echo ""
echo "========================================="
echo "âœ… æ‰€æœ‰æœåŠ¡å¯åŠ¨å®Œæˆï¼"
echo "========================================="
echo ""
echo "æœåŠ¡è®¿é—®åœ°å€ï¼š"
echo "  - å‰ç«¯: http://localhost:5173"
echo "  - Java API: http://localhost:8080"
echo "  - Python AI API: http://localhost:8001"
echo "  - APIæ–‡æ¡£(Java): http://localhost:8080/swagger-ui.html"
echo "  - APIæ–‡æ¡£(Python): http://localhost:8001/docs"
echo "  - RabbitMQç®¡ç†: http://localhost:15672 (rabbitmq/rabbitmq)"
echo "  - MinIOæ§åˆ¶å°: http://localhost:9001 (minioadmin/minioadmin)"
echo ""
echo "æŸ¥çœ‹æ—¥å¿—: docker-compose logs -f [service-name]"
echo "åœæ­¢æœåŠ¡: docker-compose down"
echo "========================================="
```

**2. Kuberneteséƒ¨ç½²è„šæœ¬**

```bash
#!/bin/bash
# scripts/deploy-k8s.sh
# Kuberneteséƒ¨ç½²è„šæœ¬

set -e

NAMESPACE="aibidcomposer"
ENVIRONMENT=${1:-production}

echo "========================================="
echo "éƒ¨ç½² AIBidComposer åˆ° Kubernetes"
echo "ç¯å¢ƒ: $ENVIRONMENT"
echo "========================================="

# åˆ›å»ºå‘½åç©ºé—´
echo "ğŸ“¦ åˆ›å»ºå‘½åç©ºé—´..."
kubectl create namespace $NAMESPACE --dry-run=client -o yaml | kubectl apply -f -

# åº”ç”¨Secrets
echo "ğŸ” åº”ç”¨Secrets..."
kubectl apply -f k8s/secrets/ -n $NAMESPACE

# åº”ç”¨ConfigMaps
echo "âš™ï¸  åº”ç”¨ConfigMaps..."
kubectl apply -f k8s/configmaps/ -n $NAMESPACE

# éƒ¨ç½²æ•°æ®æœåŠ¡ï¼ˆStatefulSetsï¼‰
echo "ğŸ’¾ éƒ¨ç½²æ•°æ®æœåŠ¡..."
kubectl apply -f k8s/statefulsets/postgres-statefulset.yaml -n $NAMESPACE
kubectl apply -f k8s/statefulsets/redis-statefulset.yaml -n $NAMESPACE
kubectl apply -f k8s/statefulsets/elasticsearch-statefulset.yaml -n $NAMESPACE
kubectl apply -f k8s/statefulsets/rabbitmq-statefulset.yaml -n $NAMESPACE

# ç­‰å¾…æ•°æ®æœåŠ¡å°±ç»ª
echo "â³ ç­‰å¾…æ•°æ®æœåŠ¡å°±ç»ª..."
kubectl wait --for=condition=ready pod -l app=postgres -n $NAMESPACE --timeout=300s
kubectl wait --for=condition=ready pod -l app=redis -n $NAMESPACE --timeout=300s
kubectl wait --for=condition=ready pod -l app=elasticsearch -n $NAMESPACE --timeout=300s
kubectl wait --for=condition=ready pod -l app=rabbitmq -n $NAMESPACE --timeout=300s

# éƒ¨ç½²åº”ç”¨æœåŠ¡ï¼ˆå…ˆJavaï¼ŒåPythonï¼‰
echo "ğŸš€ éƒ¨ç½²åº”ç”¨æœåŠ¡..."
kubectl apply -f k8s/deployments/backend-java-deployment.yaml -n $NAMESPACE

echo "â³ ç­‰å¾…JavaæœåŠ¡å°±ç»ª..."
kubectl wait --for=condition=available deployment/backend-java -n $NAMESPACE --timeout=300s

kubectl apply -f k8s/deployments/backend-python-deployment.yaml -n $NAMESPACE
kubectl apply -f k8s/deployments/frontend-deployment.yaml -n $NAMESPACE

# åº”ç”¨HPA
echo "ğŸ“Š åº”ç”¨HPA..."
kubectl apply -f k8s/hpa/ -n $NAMESPACE

# åº”ç”¨NetworkPolicy
echo "ğŸ”’ åº”ç”¨NetworkPolicy..."
kubectl apply -f k8s/network-policies/ -n $NAMESPACE

# åº”ç”¨Ingress
echo "ğŸŒ åº”ç”¨Ingress..."
kubectl apply -f k8s/ingress/ingress.yaml -n $NAMESPACE

# æ£€æŸ¥éƒ¨ç½²çŠ¶æ€
echo ""
echo "========================================="
echo "éƒ¨ç½²çŠ¶æ€æ£€æŸ¥"
echo "========================================="
kubectl get pods -n $NAMESPACE
kubectl get svc -n $NAMESPACE
kubectl get ingress -n $NAMESPACE

echo ""
echo "âœ… éƒ¨ç½²å®Œæˆï¼"
echo "========================================="
```

##### ç¯å¢ƒå˜é‡é…ç½®æ–‡ä»¶

```bash
# .env.example
# å¤åˆ¶æ­¤æ–‡ä»¶ä¸º.envå¹¶å¡«å†™å®é™…å€¼

# ====================
# æ•°æ®åº“é…ç½®
# ====================
POSTGRES_PASSWORD=your_secure_password
DATABASE_URL=postgresql://postgres:your_secure_password@postgres:5432/aibidcomposer

# ====================
# Redisé…ç½®
# ====================
REDIS_PASSWORD=your_redis_password
REDIS_URL=redis://:your_redis_password@redis:6379/0

# ====================
# Elasticsearché…ç½®
# ====================
ELASTICSEARCH_PASSWORD=your_elasticsearch_password
ELASTICSEARCH_URL=http://elasticsearch:9200

# ====================
# RabbitMQé…ç½®
# ====================
RABBITMQ_USER=rabbitmq
RABBITMQ_PASSWORD=your_rabbitmq_password
RABBITMQ_URL=amqp://rabbitmq:your_rabbitmq_password@rabbitmq:5672/

# ====================
# MinIOé…ç½®
# ====================
MINIO_ROOT_USER=minioadmin
MINIO_ROOT_PASSWORD=your_minio_password

# ====================
# åº”ç”¨é…ç½®
# ====================
SECRET_KEY=your_jwt_secret_key_min_32_characters_long
JWT_EXPIRATION=3600000

# ====================
# AIæœåŠ¡é…ç½®
# ====================
OPENAI_API_KEY=sk-your-openai-api-key
ANTHROPIC_API_KEY=your-anthropic-api-key

# ====================
# æœåŠ¡URLé…ç½®
# ====================
JAVA_SERVICE_URL=http://backend-java:8080
AI_SERVICE_URL=http://backend-python:8001

# ====================
# å‰ç«¯é…ç½®
# ====================
VITE_API_BASE_URL=http://localhost:8080
VITE_AI_API_BASE_URL=http://localhost:8001
VITE_WS_BASE_URL=ws://localhost:8080
```

##### æµ‹è¯•éªŒè¯æ­¥éª¤

**æœ¬åœ°ç¯å¢ƒæµ‹è¯•**:

```bash
# 1. å¯åŠ¨æ‰€æœ‰æœåŠ¡
./scripts/start-dev.sh

# 2. æµ‹è¯•JavaæœåŠ¡å¥åº·æ£€æŸ¥
curl http://localhost:8080/actuator/health

# 3. æµ‹è¯•PythonæœåŠ¡å¥åº·æ£€æŸ¥
curl http://localhost:8001/health

# 4. æµ‹è¯•JavaæœåŠ¡APIï¼ˆéœ€è¦å…ˆè·å–JWT tokenï¼‰
curl -X POST http://localhost:8080/api/v1/auth/login \
  -H "Content-Type: application/json" \
  -d '{"email":"test@example.com","password":"password"}'

# 5. ä½¿ç”¨tokenè®¿é—®é¡¹ç›®API
curl http://localhost:8080/api/v1/projects \
  -H "Authorization: Bearer YOUR_JWT_TOKEN" \
  -H "Content-Type: application/json"

# 6. æµ‹è¯•PythonæœåŠ¡è°ƒç”¨JavaæœåŠ¡
curl -X POST http://localhost:8001/api/v1/ai/analyze-requirements \
  -H "Authorization: Bearer YOUR_JWT_TOKEN" \
  -H "Content-Type: application/json" \
  -d '{"project_id":"uuid","input_data":{}}'

# 7. æ£€æŸ¥æœåŠ¡æ—¥å¿—
docker-compose logs -f backend-java
docker-compose logs -f backend-python
```

**Kubernetesç¯å¢ƒæµ‹è¯•**:

```bash
# 1. éƒ¨ç½²åˆ°Kubernetes
./scripts/deploy-k8s.sh production

# 2. ç«¯å£è½¬å‘æµ‹è¯•
kubectl port-forward -n aibidcomposer svc/backend-java-service 8080:8080
kubectl port-forward -n aibidcomposer svc/backend-python-service 8001:8001

# 3. æµ‹è¯•å¥åº·æ£€æŸ¥
curl http://localhost:8080/actuator/health
curl http://localhost:8001/health

# 4. æ£€æŸ¥æœåŠ¡é—´é€šä¿¡ï¼ˆåœ¨Python Podå†…æ‰§è¡Œï¼‰
kubectl exec -it -n aibidcomposer deployment/backend-python -- \
  curl http://backend-java-service:8080/actuator/health

# 5. æŸ¥çœ‹æ—¥å¿—
kubectl logs -n aibidcomposer -l app=backend-java --tail=100
kubectl logs -n aibidcomposer -l app=backend-python --tail=100

# 6. æ£€æŸ¥æœåŠ¡å‘ç°
kubectl get svc -n aibidcomposer
kubectl get endpoints -n aibidcomposer
```

---
