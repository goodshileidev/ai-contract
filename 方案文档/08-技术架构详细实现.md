---
æ–‡æ¡£ç±»å‹: æ¶æ„æ–‡æ¡£
éœ€æ±‚ç¼–å·: DOC-2025-11-002
åˆ›å»ºæ—¥æœŸ: 2025-11-15
åˆ›å»ºè€…: claude-sonnet-4-5 (claude-sonnet-4-5-20250929)
æœ€åæ›´æ–°: 2025-11-26
æ›´æ–°è€…: claude-sonnet-4-5 (claude-sonnet-4-5-20250929)
çŠ¶æ€: å·²æ‰¹å‡†
---

# AIæ ‡ä¹¦æ™ºèƒ½åˆ›ä½œå¹³å° - æŠ€æœ¯æ¶æ„è¯¦ç»†å®ç°

## ä¿®æ”¹å†å²

| æ—¥æœŸ | ç‰ˆæœ¬ | ä¿®æ”¹è€… | ä¿®æ”¹å†…å®¹æ¦‚è¦ |
|------|------|--------|-------------|
| 2025-11-26 | 2.0 | claude-sonnet-4-5 (claude-sonnet-4-5-20250929) | é‡å¤§æ›´æ–°ï¼šä»çº¯FastAPIæ¶æ„è°ƒæ•´ä¸ºæ··åˆåç«¯æ¶æ„ï¼ˆJava Spring Boot + Python FastAPIï¼‰ï¼Œæ›´æ–°æ‰€æœ‰æŠ€æœ¯æ ˆå’Œä»£ç ç¤ºä¾‹ |
| 2025-11-15 | 1.0 | claude-sonnet-4-5 (claude-sonnet-4-5-20250929) | åˆ›å»ºæŠ€æœ¯æ¶æ„è¯¦ç»†å®ç°æ–‡æ¡£ |

## ğŸ—ï¸ ç³»ç»Ÿæ¶æ„æ·±åº¦è§£æ

### æ•´ä½“æ¶æ„æ‹“æ‰‘å›¾
```mermaid
graph TB
    subgraph "å®¢æˆ·ç«¯å±‚"
        A[Webå‰ç«¯åº”ç”¨ - React + Ant Design Pro]
        B[ç§»åŠ¨ç«¯åº”ç”¨]
        C[æ¡Œé¢å®¢æˆ·ç«¯]
        D[å¼€æ”¾APIå®¢æˆ·ç«¯]
    end

    subgraph "APIç½‘å…³å±‚"
        E[Kong API Gateway]
        F[è®¤è¯æˆæƒæœåŠ¡]
        G[é™æµç†”æ–­]
        H[è´Ÿè½½å‡è¡¡]
    end

    subgraph "Javaä¸šåŠ¡æœåŠ¡å±‚ - Spring Boot 3.2"
        I[ç”¨æˆ·æœåŠ¡ - 8080]
        J[é¡¹ç›®æœåŠ¡ - 8080]
        K[æ¨¡æ¿æœåŠ¡ - 8080]
        L[æ–‡æ¡£æœåŠ¡ - 8080]
        M[åä½œæœåŠ¡ - 8080]
        N[å¯¼å‡ºæœåŠ¡ - 8080]
    end

    subgraph "Python AIæœåŠ¡å±‚ - FastAPI 0.104"
        O[LLMæœåŠ¡ - 8001]
        P[RAGæœåŠ¡ - LlamaIndex - 8001]
        Q[å‘é‡æ£€ç´¢æœåŠ¡ - Elasticsearch - 8001]
        R[å·¥ä½œæµå¼•æ“ - LangChain - 8001]
        S[å†…å®¹ç”ŸæˆæœåŠ¡ - 8001]
    end

    subgraph "æ•°æ®å­˜å‚¨å±‚"
        T[PostgreSQL 15é›†ç¾¤]
        U[Redis 7é›†ç¾¤]
        V[MinIOå¯¹è±¡å­˜å‚¨]
        W[Elasticsearch 8+ å‘é‡æ•°æ®åº“]
        X[RabbitMQæ¶ˆæ¯é˜Ÿåˆ—]
    end

    subgraph "åŸºç¡€è®¾æ–½å±‚"
        Y[Kubernetesé›†ç¾¤]
        Z[Prometheus + Grafanaç›‘æ§]
        AA[ELKæ—¥å¿—ç³»ç»Ÿ]
        BB[Jenkins CI/CD]
    end

    A --> E
    B --> E
    C --> E
    D --> E

    E --> I
    E --> J
    E --> K
    E --> L
    E --> M
    E --> N

    I -.HTTPè°ƒç”¨.-> O
    J -.HTTPè°ƒç”¨.-> P
    K -.HTTPè°ƒç”¨.-> Q
    L -.HTTPè°ƒç”¨.-> S

    O --> W
    P --> W
    Q --> W

    I --> T
    J --> T
    K --> T
    L --> T
    M --> T
    N --> T

    I --> U
    J --> U
    K --> U
    L --> U
    M --> U
    N --> U

    L --> V
    N --> V
```

## ğŸ¨ å‰ç«¯æ¶æ„è¯¦ç»†å®ç°

### ç»„ä»¶æ¶æ„è®¾è®¡
```typescript
// ç»„ä»¶å±‚æ¬¡ç»“æ„è¯¦ç»†è®¾è®¡
src/
â”œâ”€â”€ components/                    # é€šç”¨ç»„ä»¶åº“
â”‚   â”œâ”€â”€ ui/                       # åŸºç¡€UIç»„ä»¶ï¼ˆAnt Design Proï¼‰
â”‚   â”‚   â”œâ”€â”€ Button/
â”‚   â”‚   â”‚   â”œâ”€â”€ index.tsx
â”‚   â”‚   â”‚   â”œâ”€â”€ Button.styles.ts
â”‚   â”‚   â”‚   â”œâ”€â”€ Button.types.ts
â”‚   â”‚   â”‚   â””â”€â”€ Button.test.tsx
â”‚   â”‚   â”œâ”€â”€ Input/
â”‚   â”‚   â”œâ”€â”€ Modal/
â”‚   â”‚   â”œâ”€â”€ Table/
â”‚   â”‚   â””â”€â”€ ...
â”‚   â”œâ”€â”€ forms/                    # è¡¨å•ç»„ä»¶
â”‚   â”‚   â”œâ”€â”€ FormField/
â”‚   â”‚   â”œâ”€â”€ FormValidation/
â”‚   â”‚   â””â”€â”€ FormBuilder/
â”‚   â”œâ”€â”€ layout/                   # å¸ƒå±€ç»„ä»¶
â”‚   â”‚   â”œâ”€â”€ Header/
â”‚   â”‚   â”œâ”€â”€ Sidebar/
â”‚   â”‚   â”œâ”€â”€ Footer/
â”‚   â”‚   â””â”€â”€ ProLayout/           # Ant Design Pro Layout
â”‚   â””â”€â”€ charts/                   # å›¾è¡¨ç»„ä»¶
â”‚       â”œâ”€â”€ LineChart/
â”‚       â”œâ”€â”€ BarChart/
â”‚       â””â”€â”€ PieChart/
â”œâ”€â”€ features/                     # åŠŸèƒ½æ¨¡å—
â”‚   â”œâ”€â”€ auth/                     # è®¤è¯æ¨¡å—
â”‚   â”‚   â”œâ”€â”€ components/
â”‚   â”‚   â”œâ”€â”€ hooks/
â”‚   â”‚   â”œâ”€â”€ services/
â”‚   â”‚   â””â”€â”€ types/
â”‚   â”œâ”€â”€ projects/                 # é¡¹ç›®ç®¡ç†
â”‚   â”‚   â”œâ”€â”€ components/
â”‚   â”‚   â”‚   â”œâ”€â”€ ProjectList/
â”‚   â”‚   â”‚   â”œâ”€â”€ ProjectDetail/
â”‚   â”‚   â”‚   â”œâ”€â”€ ProjectForm/
â”‚   â”‚   â”‚   â””â”€â”€ ProjectDashboard/
â”‚   â”‚   â”œâ”€â”€ hooks/
â”‚   â”‚   â”‚   â”œâ”€â”€ useProjects.ts
â”‚   â”‚   â”‚   â”œâ”€â”€ useProjectDetail.ts
â”‚   â”‚   â”‚   â””â”€â”€ useProjectForm.ts
â”‚   â”‚   â”œâ”€â”€ services/
â”‚   â”‚   â”‚   â”œâ”€â”€ projectApi.ts
â”‚   â”‚   â”‚   â””â”€â”€ projectUtils.ts
â”‚   â”‚   â””â”€â”€ types/
â”‚   â”‚       â”œâ”€â”€ project.types.ts
â”‚   â”‚       â””â”€â”€ projectApi.types.ts
â”‚   â”œâ”€â”€ templates/                # æ¨¡æ¿ç®¡ç†
â”‚   â”œâ”€â”€ ai-assistant/             # AIåŠ©æ‰‹
â”‚   â”œâ”€â”€ documents/                # æ–‡æ¡£ç®¡ç†
â”‚   â”œâ”€â”€ collaboration/            # åä½œåŠŸèƒ½
â”‚   â””â”€â”€ export/                   # å¯¼å‡ºåŠŸèƒ½
â”œâ”€â”€ hooks/                        # å…¨å±€Hooks
â”‚   â”œâ”€â”€ useAuth.ts
â”‚   â”œâ”€â”€ useApi.ts
â”‚   â”œâ”€â”€ useLocalStorage.ts
â”‚   â””â”€â”€ useWebSocket.ts
â”œâ”€â”€ services/                     # APIæœåŠ¡
â”‚   â”œâ”€â”€ api.ts                    # APIåŸºç¡€é…ç½®
â”‚   â”œâ”€â”€ javaService.ts            # JavaæœåŠ¡API
â”‚   â”œâ”€â”€ aiService.ts              # Python AIæœåŠ¡API
â”‚   â”œâ”€â”€ auth.ts                   # è®¤è¯æœåŠ¡
â”‚   â”œâ”€â”€ projects.ts               # é¡¹ç›®æœåŠ¡
â”‚   â”œâ”€â”€ templates.ts              # æ¨¡æ¿æœåŠ¡
â”‚   â””â”€â”€ documents.ts              # æ–‡æ¡£æœåŠ¡
â”œâ”€â”€ stores/                       # çŠ¶æ€ç®¡ç†
â”‚   â”œâ”€â”€ authStore.ts
â”‚   â”œâ”€â”€ projectStore.ts
â”‚   â”œâ”€â”€ uiStore.ts
â”‚   â””â”€â”€ index.ts
â”œâ”€â”€ utils/                        # å·¥å…·å‡½æ•°
â”‚   â”œâ”€â”€ constants.ts
â”‚   â”œâ”€â”€ helpers.ts
â”‚   â”œâ”€â”€ validators.ts
â”‚   â””â”€â”€ formatters.ts
â”œâ”€â”€ types/                        # TypeScriptç±»å‹å®šä¹‰
â”‚   â”œâ”€â”€ api.types.ts
â”‚   â”œâ”€â”€ auth.types.ts
â”‚   â”œâ”€â”€ project.types.ts
â”‚   â””â”€â”€ common.types.ts
â””â”€â”€ styles/                       # æ ·å¼æ–‡ä»¶
    â”œâ”€â”€ globals.less              # Ant Designä½¿ç”¨Less
    â”œâ”€â”€ variables.less
    â””â”€â”€ components/
```

### APIæœåŠ¡å°è£…å®ç°
```typescript
// æœåŠ¡åŸºç¡€é…ç½® - services/api.ts
import axios, { AxiosInstance, AxiosRequestConfig } from 'axios';

// Javaä¸šåŠ¡æœåŠ¡é…ç½®
const javaServiceConfig: AxiosRequestConfig = {
  baseURL: import.meta.env.VITE_JAVA_SERVICE_URL || 'http://localhost:8080/api/v1',
  timeout: 10000,
  headers: {
    'Content-Type': 'application/json',
  },
};

// Python AIæœåŠ¡é…ç½®
const aiServiceConfig: AxiosRequestConfig = {
  baseURL: import.meta.env.VITE_AI_SERVICE_URL || 'http://localhost:8001/api/v1',
  timeout: 60000, // AIæœåŠ¡å“åº”æ—¶é—´è¾ƒé•¿
  headers: {
    'Content-Type': 'application/json',
  },
};

// åˆ›å»ºaxioså®ä¾‹
export const javaServiceClient: AxiosInstance = axios.create(javaServiceConfig);
export const aiServiceClient: AxiosInstance = axios.create(aiServiceConfig);

// è¯·æ±‚æ‹¦æˆªå™¨ - æ·»åŠ è®¤è¯token
const requestInterceptor = (config: any) => {
  const token = localStorage.getItem('token');
  if (token) {
    config.headers.Authorization = `Bearer ${token}`;
  }
  return config;
};

javaServiceClient.interceptors.request.use(requestInterceptor);
aiServiceClient.interceptors.request.use(requestInterceptor);

// å“åº”æ‹¦æˆªå™¨ - ç»Ÿä¸€é”™è¯¯å¤„ç†
const responseInterceptor = (error: any) => {
  if (error.response?.status === 401) {
    // Tokenè¿‡æœŸï¼Œè·³è½¬ç™»å½•
    window.location.href = '/login';
  }
  return Promise.reject(error);
};

javaServiceClient.interceptors.response.use(
  (response) => response,
  responseInterceptor
);

aiServiceClient.interceptors.response.use(
  (response) => response,
  responseInterceptor
);

// é¡¹ç›®æœåŠ¡API - services/projects.ts
import { javaServiceClient, aiServiceClient } from './api';
import type { Project, CreateProjectRequest, DocumentAnalysisRequest } from '@/types';

export const projectService = {
  // JavaæœåŠ¡ - é¡¹ç›®CRUDæ“ä½œ
  async getProjects(params?: {
    page?: number;
    limit?: number;
    status?: string;
    search?: string;
  }) {
    const response = await javaServiceClient.get('/projects', { params });
    return response.data;
  },

  async getProject(id: string) {
    const response = await javaServiceClient.get(`/projects/${id}`);
    return response.data;
  },

  async createProject(data: CreateProjectRequest) {
    const response = await javaServiceClient.post('/projects', data);
    return response.data;
  },

  async updateProject(id: string, data: Partial<Project>) {
    const response = await javaServiceClient.put(`/projects/${id}`, data);
    return response.data;
  },

  async deleteProject(id: string) {
    const response = await javaServiceClient.delete(`/projects/${id}`);
    return response.data;
  },

  // Python AIæœåŠ¡ - æ‹›æ ‡æ–‡æ¡£åˆ†æ
  async analyzeTenderDocument(data: DocumentAnalysisRequest) {
    const response = await aiServiceClient.post('/analyze/document', data);
    return response.data;
  },

  // Python AIæœåŠ¡ - ç”Ÿæˆæ ‡ä¹¦å†…å®¹
  async generateBidContent(data: {
    projectId: string;
    templateId: string;
    requirements: object;
    companyProfile: object;
  }) {
    const response = await aiServiceClient.post('/generate/content', data);
    return response.data;
  },
};
```

### çŠ¶æ€ç®¡ç†è¯¦ç»†å®ç°
```typescript
// ä½¿ç”¨Zustandè¿›è¡ŒçŠ¶æ€ç®¡ç† - stores/projectStore.ts
import { create } from 'zustand';
import { devtools, persist } from 'zustand/middleware';
import { projectService } from '@/services/projects';
import type { Project, ProjectFilters, Pagination } from '@/types';

interface ProjectState {
  projects: Project[];
  currentProject: Project | null;
  loading: boolean;
  error: string | null;
  filters: ProjectFilters;
  pagination: Pagination;

  // Actions
  fetchProjects: (params?: any) => Promise<void>;
  fetchProject: (id: string) => Promise<void>;
  createProject: (project: any) => Promise<Project>;
  updateProject: (id: string, project: any) => Promise<Project>;
  deleteProject: (id: string) => Promise<void>;
  analyzeTender: (documentId: string, content: string) => Promise<any>;
  generateContent: (params: any) => Promise<any>;
  setFilters: (filters: Partial<ProjectFilters>) => void;
  setPagination: (pagination: Partial<Pagination>) => void;
  reset: () => void;
}

const initialState = {
  projects: [],
  currentProject: null,
  loading: false,
  error: null,
  filters: {},
  pagination: { page: 1, limit: 20, total: 0 },
};

export const useProjectStore = create<ProjectState>()(
  devtools(
    persist(
      (set, get) => ({
        ...initialState,

        fetchProjects: async (params) => {
          set({ loading: true, error: null });

          try {
            const response = await projectService.getProjects({
              ...get().filters,
              ...get().pagination,
              ...params,
            });

            set({
              projects: response.data.projects,
              pagination: response.data.pagination,
              loading: false,
            });
          } catch (error: any) {
            set({
              error: error.message,
              loading: false,
            });
          }
        },

        fetchProject: async (id) => {
          set({ loading: true, error: null });

          try {
            const response = await projectService.getProject(id);
            set({
              currentProject: response.data,
              loading: false,
            });
          } catch (error: any) {
            set({
              error: error.message,
              loading: false,
            });
          }
        },

        createProject: async (project) => {
          try {
            const response = await projectService.createProject(project);
            const newProject = response.data;

            set((state) => ({
              projects: [newProject, ...state.projects],
            }));

            return newProject;
          } catch (error: any) {
            set({ error: error.message });
            throw error;
          }
        },

        updateProject: async (id, project) => {
          try {
            const response = await projectService.updateProject(id, project);
            const updatedProject = response.data;

            set((state) => ({
              projects: state.projects.map((p) =>
                p.id === id ? updatedProject : p
              ),
              currentProject:
                state.currentProject?.id === id
                  ? updatedProject
                  : state.currentProject,
            }));

            return updatedProject;
          } catch (error: any) {
            set({ error: error.message });
            throw error;
          }
        },

        deleteProject: async (id) => {
          try {
            await projectService.deleteProject(id);

            set((state) => ({
              projects: state.projects.filter((p) => p.id !== id),
              currentProject:
                state.currentProject?.id === id ? null : state.currentProject,
            }));
          } catch (error: any) {
            set({ error: error.message });
            throw error;
          }
        },

        // AIæœåŠ¡è°ƒç”¨
        analyzeTender: async (documentId, content) => {
          set({ loading: true, error: null });

          try {
            const response = await projectService.analyzeTenderDocument({
              documentId,
              documentContent: content,
              documentType: 'tender',
              analysisOptions: ['requirements', 'risks', 'opportunities'],
            });

            set({ loading: false });
            return response.data;
          } catch (error: any) {
            set({ error: error.message, loading: false });
            throw error;
          }
        },

        generateContent: async (params) => {
          set({ loading: true, error: null });

          try {
            const response = await projectService.generateBidContent(params);
            set({ loading: false });
            return response.data;
          } catch (error: any) {
            set({ error: error.message, loading: false });
            throw error;
          }
        },

        setFilters: (filters) => {
          set((state) => ({
            filters: { ...state.filters, ...filters },
          }));
        },

        setPagination: (pagination) => {
          set((state) => ({
            pagination: { ...state.pagination, ...pagination },
          }));
        },

        reset: () => set(initialState),
      }),
      {
        name: 'project-store',
        partialize: (state) => ({
          filters: state.filters,
          pagination: state.pagination,
        }),
      }
    ),
    { name: 'project-store' }
  )
);
```

## âš™ï¸ Javaåç«¯æœåŠ¡è¯¦ç»†å®ç°

### Spring Booté¡¹ç›®ç»“æ„
```
java-service/
â”œâ”€â”€ src/
â”‚   â”œâ”€â”€ main/
â”‚   â”‚   â”œâ”€â”€ java/
â”‚   â”‚   â”‚   â””â”€â”€ com/aibidcomposer/
â”‚   â”‚   â”‚       â”œâ”€â”€ AibidApplication.java
â”‚   â”‚   â”‚       â”œâ”€â”€ config/              # é…ç½®ç±»
â”‚   â”‚   â”‚       â”‚   â”œâ”€â”€ SecurityConfig.java
â”‚   â”‚   â”‚       â”‚   â”œâ”€â”€ RedisConfig.java
â”‚   â”‚   â”‚       â”‚   â”œâ”€â”€ WebClientConfig.java
â”‚   â”‚   â”‚       â”‚   â””â”€â”€ JpaConfig.java
â”‚   â”‚   â”‚       â”œâ”€â”€ controller/          # æ§åˆ¶å™¨
â”‚   â”‚   â”‚       â”‚   â”œâ”€â”€ UserController.java
â”‚   â”‚   â”‚       â”‚   â”œâ”€â”€ ProjectController.java
â”‚   â”‚   â”‚       â”‚   â”œâ”€â”€ TemplateController.java
â”‚   â”‚   â”‚       â”‚   â””â”€â”€ DocumentController.java
â”‚   â”‚   â”‚       â”œâ”€â”€ service/             # ä¸šåŠ¡é€»è¾‘å±‚
â”‚   â”‚   â”‚       â”‚   â”œâ”€â”€ UserService.java
â”‚   â”‚   â”‚       â”‚   â”œâ”€â”€ ProjectService.java
â”‚   â”‚   â”‚       â”‚   â”œâ”€â”€ AIServiceClient.java
â”‚   â”‚   â”‚       â”‚   â””â”€â”€ impl/
â”‚   â”‚   â”‚       â”œâ”€â”€ repository/          # æ•°æ®è®¿é—®å±‚
â”‚   â”‚   â”‚       â”‚   â”œâ”€â”€ UserRepository.java
â”‚   â”‚   â”‚       â”‚   â”œâ”€â”€ ProjectRepository.java
â”‚   â”‚   â”‚       â”‚   â””â”€â”€ TemplateRepository.java
â”‚   â”‚   â”‚       â”œâ”€â”€ entity/              # å®ä½“ç±»
â”‚   â”‚   â”‚       â”‚   â”œâ”€â”€ User.java
â”‚   â”‚   â”‚       â”‚   â”œâ”€â”€ Project.java
â”‚   â”‚   â”‚       â”‚   â”œâ”€â”€ Template.java
â”‚   â”‚   â”‚       â”‚   â””â”€â”€ Document.java
â”‚   â”‚   â”‚       â”œâ”€â”€ dto/                 # æ•°æ®ä¼ è¾“å¯¹è±¡
â”‚   â”‚   â”‚       â”‚   â”œâ”€â”€ request/
â”‚   â”‚   â”‚       â”‚   â””â”€â”€ response/
â”‚   â”‚   â”‚       â”œâ”€â”€ exception/           # å¼‚å¸¸å¤„ç†
â”‚   â”‚   â”‚       â”‚   â”œâ”€â”€ GlobalExceptionHandler.java
â”‚   â”‚   â”‚       â”‚   â””â”€â”€ BusinessException.java
â”‚   â”‚   â”‚       â”œâ”€â”€ security/            # å®‰å…¨ç›¸å…³
â”‚   â”‚   â”‚       â”‚   â”œâ”€â”€ JwtTokenProvider.java
â”‚   â”‚   â”‚       â”‚   â”œâ”€â”€ JwtAuthenticationFilter.java
â”‚   â”‚   â”‚       â”‚   â””â”€â”€ UserDetailsServiceImpl.java
â”‚   â”‚   â”‚       â””â”€â”€ util/                # å·¥å…·ç±»
â”‚   â”‚   â”‚           â”œâ”€â”€ ResponseUtil.java
â”‚   â”‚   â”‚           â””â”€â”€ DateUtil.java
â”‚   â”‚   â””â”€â”€ resources/
â”‚   â”‚       â”œâ”€â”€ application.yml
â”‚   â”‚       â”œâ”€â”€ application-dev.yml
â”‚   â”‚       â””â”€â”€ application-prod.yml
â”‚   â””â”€â”€ test/
â”œâ”€â”€ pom.xml
â””â”€â”€ Dockerfile
```

### ç”¨æˆ·æœåŠ¡å®ç°
```java
// å®ä½“ç±» - entity/User.java
package com.aibidcomposer.entity;

import jakarta.persistence.*;
import lombok.Data;
import lombok.NoArgsConstructor;
import lombok.AllArgsConstructor;
import org.hibernate.annotations.GenericGenerator;

import java.time.LocalDateTime;
import java.util.UUID;

@Entity
@Table(name = "users")
@Data
@NoArgsConstructor
@AllArgsConstructor
public class User {

    @Id
    @GeneratedValue(generator = "UUID")
    @GenericGenerator(name = "UUID", strategy = "org.hibernate.id.UUIDGenerator")
    @Column(name = "id", updatable = false, nullable = false)
    private UUID id;

    @Column(name = "username", unique = true, nullable = false, length = 50)
    private String username;

    @Column(name = "email", unique = true, nullable = false, length = 100)
    private String email;

    @Column(name = "password_hash", nullable = false, length = 255)
    private String passwordHash;

    @Column(name = "full_name", length = 100)
    private String fullName;

    @Column(name = "company_id")
    private UUID companyId;

    @Column(name = "role", nullable = false, length = 20)
    private String role = "user";

    @Column(name = "is_active")
    private Boolean isActive = true;

    @Column(name = "is_verified")
    private Boolean isVerified = false;

    @Column(name = "avatar_url", length = 500)
    private String avatarUrl;

    @Column(name = "phone", length = 20)
    private String phone;

    @Column(name = "department", length = 100)
    private String department;

    @Column(name = "position", length = 100)
    private String position;

    @Column(name = "created_at", nullable = false, updatable = false)
    private LocalDateTime createdAt = LocalDateTime.now();

    @Column(name = "updated_at")
    private LocalDateTime updatedAt = LocalDateTime.now();

    @Column(name = "last_login_at")
    private LocalDateTime lastLoginAt;

    @PreUpdate
    protected void onUpdate() {
        updatedAt = LocalDateTime.now();
    }
}

// æ•°æ®è®¿é—®å±‚ - repository/UserRepository.java
package com.aibidcomposer.repository;

import com.aibidcomposer.entity.User;
import org.springframework.data.jpa.repository.JpaRepository;
import org.springframework.data.jpa.repository.Query;
import org.springframework.stereotype.Repository;

import java.util.Optional;
import java.util.UUID;

@Repository
public interface UserRepository extends JpaRepository<User, UUID> {

    Optional<User> findByUsername(String username);

    Optional<User> findByEmail(String email);

    @Query("SELECT u FROM User u WHERE u.username = :identifier OR u.email = :identifier")
    Optional<User> findByUsernameOrEmail(String identifier);

    boolean existsByUsername(String username);

    boolean existsByEmail(String email);
}

// DTO - dto/request/LoginRequest.java
package com.aibidcomposer.dto.request;

import jakarta.validation.constraints.Email;
import jakarta.validation.constraints.NotBlank;
import lombok.Data;

@Data
public class LoginRequest {

    @NotBlank(message = "ç”¨æˆ·åä¸èƒ½ä¸ºç©º")
    private String username;

    @NotBlank(message = "å¯†ç ä¸èƒ½ä¸ºç©º")
    private String password;
}

// DTO - dto/response/LoginResponse.java
package com.aibidcomposer.dto.response;

import lombok.AllArgsConstructor;
import lombok.Builder;
import lombok.Data;
import lombok.NoArgsConstructor;

@Data
@Builder
@NoArgsConstructor
@AllArgsConstructor
public class LoginResponse {

    private String accessToken;
    private String refreshToken;
    private String tokenType = "Bearer";
    private Integer expiresIn;
    private UserResponse user;
}

// ä¸šåŠ¡é€»è¾‘å±‚ - service/UserService.java
package com.aibidcomposer.service;

import com.aibidcomposer.dto.request.LoginRequest;
import com.aibidcomposer.dto.request.RegisterRequest;
import com.aibidcomposer.dto.response.LoginResponse;
import com.aibidcomposer.dto.response.UserResponse;
import com.aibidcomposer.entity.User;
import com.aibidcomposer.exception.BusinessException;
import com.aibidcomposer.repository.UserRepository;
import com.aibidcomposer.security.JwtTokenProvider;
import lombok.RequiredArgsConstructor;
import org.springframework.security.crypto.password.PasswordEncoder;
import org.springframework.stereotype.Service;
import org.springframework.transaction.annotation.Transactional;

import java.time.LocalDateTime;
import java.util.UUID;

@Service
@RequiredArgsConstructor
public class UserService {

    private final UserRepository userRepository;
    private final PasswordEncoder passwordEncoder;
    private final JwtTokenProvider jwtTokenProvider;

    /**
     * ç”¨æˆ·æ³¨å†Œ
     */
    @Transactional
    public UserResponse register(RegisterRequest request) {
        // æ£€æŸ¥ç”¨æˆ·åæ˜¯å¦å·²å­˜åœ¨
        if (userRepository.existsByUsername(request.getUsername())) {
            throw new BusinessException("ç”¨æˆ·åå·²å­˜åœ¨");
        }

        // æ£€æŸ¥é‚®ç®±æ˜¯å¦å·²å­˜åœ¨
        if (userRepository.existsByEmail(request.getEmail())) {
            throw new BusinessException("é‚®ç®±å·²è¢«æ³¨å†Œ");
        }

        // åˆ›å»ºæ–°ç”¨æˆ·
        User user = new User();
        user.setUsername(request.getUsername());
        user.setEmail(request.getEmail());
        user.setPasswordHash(passwordEncoder.encode(request.getPassword()));
        user.setFullName(request.getFullName());
        user.setCompanyId(request.getCompanyId());
        user.setRole("user");

        User savedUser = userRepository.save(user);

        // å‘é€éªŒè¯é‚®ä»¶ï¼ˆå¼‚æ­¥ï¼‰
        // emailService.sendVerificationEmail(savedUser.getEmail());

        return mapToUserResponse(savedUser);
    }

    /**
     * ç”¨æˆ·ç™»å½•
     */
    @Transactional
    public LoginResponse login(LoginRequest request) {
        // æŸ¥æ‰¾ç”¨æˆ·
        User user = userRepository.findByUsernameOrEmail(request.getUsername())
            .orElseThrow(() -> new BusinessException("ç”¨æˆ·åæˆ–å¯†ç é”™è¯¯"));

        // éªŒè¯å¯†ç 
        if (!passwordEncoder.matches(request.getPassword(), user.getPasswordHash())) {
            throw new BusinessException("ç”¨æˆ·åæˆ–å¯†ç é”™è¯¯");
        }

        // æ£€æŸ¥ç”¨æˆ·çŠ¶æ€
        if (!user.getIsActive()) {
            throw new BusinessException("è´¦æˆ·å·²è¢«ç¦ç”¨");
        }

        // æ›´æ–°æœ€åç™»å½•æ—¶é—´
        user.setLastLoginAt(LocalDateTime.now());
        userRepository.save(user);

        // ç”ŸæˆJWT Token
        String accessToken = jwtTokenProvider.generateToken(user.getId().toString());
        String refreshToken = jwtTokenProvider.generateRefreshToken(user.getId().toString());

        return LoginResponse.builder()
            .accessToken(accessToken)
            .refreshToken(refreshToken)
            .tokenType("Bearer")
            .expiresIn(jwtTokenProvider.getExpirationTime())
            .user(mapToUserResponse(user))
            .build();
    }

    /**
     * è·å–ç”¨æˆ·ä¿¡æ¯
     */
    public UserResponse getUserById(UUID userId) {
        User user = userRepository.findById(userId)
            .orElseThrow(() -> new BusinessException("ç”¨æˆ·ä¸å­˜åœ¨"));

        return mapToUserResponse(user);
    }

    /**
     * æ›´æ–°ç”¨æˆ·ä¿¡æ¯
     */
    @Transactional
    public UserResponse updateUser(UUID userId, UpdateUserRequest request) {
        User user = userRepository.findById(userId)
            .orElseThrow(() -> new BusinessException("ç”¨æˆ·ä¸å­˜åœ¨"));

        if (request.getFullName() != null) {
            user.setFullName(request.getFullName());
        }
        if (request.getAvatarUrl() != null) {
            user.setAvatarUrl(request.getAvatarUrl());
        }
        if (request.getPhone() != null) {
            user.setPhone(request.getPhone());
        }
        if (request.getDepartment() != null) {
            user.setDepartment(request.getDepartment());
        }
        if (request.getPosition() != null) {
            user.setPosition(request.getPosition());
        }

        User updatedUser = userRepository.save(user);

        return mapToUserResponse(updatedUser);
    }

    private UserResponse mapToUserResponse(User user) {
        return UserResponse.builder()
            .id(user.getId())
            .username(user.getUsername())
            .email(user.getEmail())
            .fullName(user.getFullName())
            .companyId(user.getCompanyId())
            .role(user.getRole())
            .isActive(user.getIsActive())
            .isVerified(user.getIsVerified())
            .avatarUrl(user.getAvatarUrl())
            .phone(user.getPhone())
            .department(user.getDepartment())
            .position(user.getPosition())
            .createdAt(user.getCreatedAt())
            .lastLoginAt(user.getLastLoginAt())
            .build();
    }
}

// æ§åˆ¶å™¨ - controller/UserController.java
package com.aibidcomposer.controller;

import com.aibidcomposer.dto.request.LoginRequest;
import com.aibidcomposer.dto.request.RegisterRequest;
import com.aibidcomposer.dto.response.ApiResponse;
import com.aibidcomposer.dto.response.LoginResponse;
import com.aibidcomposer.dto.response.UserResponse;
import com.aibidcomposer.service.UserService;
import com.aibidcomposer.util.ResponseUtil;
import jakarta.validation.Valid;
import lombok.RequiredArgsConstructor;
import org.springframework.http.ResponseEntity;
import org.springframework.security.core.annotation.AuthenticationPrincipal;
import org.springframework.web.bind.annotation.*;

import java.util.UUID;

@RestController
@RequestMapping("/api/v1/users")
@RequiredArgsConstructor
public class UserController {

    private final UserService userService;

    /**
     * ç”¨æˆ·æ³¨å†Œ
     */
    @PostMapping("/register")
    public ResponseEntity<ApiResponse<UserResponse>> register(
        @Valid @RequestBody RegisterRequest request
    ) {
        UserResponse user = userService.register(request);
        return ResponseUtil.success(user, "æ³¨å†ŒæˆåŠŸ");
    }

    /**
     * ç”¨æˆ·ç™»å½•
     */
    @PostMapping("/login")
    public ResponseEntity<ApiResponse<LoginResponse>> login(
        @Valid @RequestBody LoginRequest request
    ) {
        LoginResponse response = userService.login(request);
        return ResponseUtil.success(response, "ç™»å½•æˆåŠŸ");
    }

    /**
     * è·å–å½“å‰ç”¨æˆ·ä¿¡æ¯
     */
    @GetMapping("/me")
    public ResponseEntity<ApiResponse<UserResponse>> getCurrentUser(
        @AuthenticationPrincipal String userId
    ) {
        UserResponse user = userService.getUserById(UUID.fromString(userId));
        return ResponseUtil.success(user);
    }

    /**
     * æ›´æ–°ç”¨æˆ·ä¿¡æ¯
     */
    @PutMapping("/me")
    public ResponseEntity<ApiResponse<UserResponse>> updateCurrentUser(
        @AuthenticationPrincipal String userId,
        @Valid @RequestBody UpdateUserRequest request
    ) {
        UserResponse user = userService.updateUser(UUID.fromString(userId), request);
        return ResponseUtil.success(user, "æ›´æ–°æˆåŠŸ");
    }
}
```

### AIæœåŠ¡å®¢æˆ·ç«¯å®ç°
```java
// AIæœåŠ¡å®¢æˆ·ç«¯ - service/AIServiceClient.java
package com.aibidcomposer.service;

import com.aibidcomposer.dto.ai.DocumentAnalysisRequest;
import com.aibidcomposer.dto.ai.DocumentAnalysisResponse;
import com.aibidcomposer.dto.ai.ContentGenerationRequest;
import com.aibidcomposer.dto.ai.ContentGenerationResponse;
import lombok.RequiredArgsConstructor;
import lombok.extern.slf4j.Slf4j;
import org.springframework.beans.factory.annotation.Value;
import org.springframework.stereotype.Service;
import org.springframework.web.reactive.function.client.WebClient;
import reactor.core.publisher.Mono;

import java.time.Duration;

@Slf4j
@Service
@RequiredArgsConstructor
public class AIServiceClient {

    private final WebClient webClient;

    @Value("${ai.service.url}")
    private String aiServiceUrl; // http://python-ai-service:8001

    /**
     * åˆ†ææ‹›æ ‡æ–‡æ¡£
     */
    public DocumentAnalysisResponse analyzeTenderDocument(
        String documentId,
        String content,
        String documentType
    ) {
        log.info("è°ƒç”¨AIæœåŠ¡åˆ†ææ–‡æ¡£: {}", documentId);

        DocumentAnalysisRequest request = DocumentAnalysisRequest.builder()
            .documentId(documentId)
            .documentContent(content)
            .documentType(documentType)
            .analysisOptions(List.of("requirements", "risks", "opportunities"))
            .build();

        return webClient.post()
            .uri(aiServiceUrl + "/api/v1/analyze/document")
            .bodyValue(request)
            .retrieve()
            .bodyToMono(DocumentAnalysisResponse.class)
            .timeout(Duration.ofSeconds(60))
            .doOnError(error -> log.error("AIæ–‡æ¡£åˆ†æå¤±è´¥", error))
            .block();
    }

    /**
     * ç”Ÿæˆæ ‡ä¹¦å†…å®¹
     */
    public ContentGenerationResponse generateBidContent(
        String projectId,
        String templateId,
        Map<String, Object> requirements,
        Map<String, Object> companyProfile
    ) {
        log.info("è°ƒç”¨AIæœåŠ¡ç”Ÿæˆå†…å®¹: project={}, template={}", projectId, templateId);

        ContentGenerationRequest request = ContentGenerationRequest.builder()
            .projectId(projectId)
            .templateId(templateId)
            .requirements(requirements)
            .companyProfile(companyProfile)
            .build();

        return webClient.post()
            .uri(aiServiceUrl + "/api/v1/generate/content")
            .bodyValue(request)
            .retrieve()
            .bodyToMono(ContentGenerationResponse.class)
            .timeout(Duration.ofSeconds(120))
            .doOnError(error -> log.error("AIå†…å®¹ç”Ÿæˆå¤±è´¥", error))
            .block();
    }

    /**
     * å¼‚æ­¥åˆ†ææ–‡æ¡£
     */
    public Mono<DocumentAnalysisResponse> analyzeTenderDocumentAsync(
        String documentId,
        String content,
        String documentType
    ) {
        log.info("å¼‚æ­¥è°ƒç”¨AIæœåŠ¡åˆ†ææ–‡æ¡£: {}", documentId);

        DocumentAnalysisRequest request = DocumentAnalysisRequest.builder()
            .documentId(documentId)
            .documentContent(content)
            .documentType(documentType)
            .analysisOptions(List.of("requirements", "risks", "opportunities"))
            .build();

        return webClient.post()
            .uri(aiServiceUrl + "/api/v1/analyze/document")
            .bodyValue(request)
            .retrieve()
            .bodyToMono(DocumentAnalysisResponse.class)
            .timeout(Duration.ofSeconds(60))
            .doOnError(error -> log.error("AIæ–‡æ¡£åˆ†æå¤±è´¥", error));
    }
}

// WebClienté…ç½® - config/WebClientConfig.java
package com.aibidcomposer.config;

import org.springframework.context.annotation.Bean;
import org.springframework.context.annotation.Configuration;
import org.springframework.web.reactive.function.client.WebClient;

@Configuration
public class WebClientConfig {

    @Bean
    public WebClient webClient(WebClient.Builder builder) {
        return builder
            .codecs(configurer -> configurer
                .defaultCodecs()
                .maxInMemorySize(16 * 1024 * 1024)) // 16MB
            .build();
    }
}
```

## ğŸ¤– Python AIæœåŠ¡è¯¦ç»†å®ç°

### FastAPIé¡¹ç›®ç»“æ„
```
python-ai-service/
â”œâ”€â”€ app/
â”‚   â”œâ”€â”€ __init__.py
â”‚   â”œâ”€â”€ main.py                      # FastAPIåº”ç”¨å…¥å£
â”‚   â”œâ”€â”€ config/                      # é…ç½®
â”‚   â”‚   â”œâ”€â”€ __init__.py
â”‚   â”‚   â”œâ”€â”€ settings.py
â”‚   â”‚   â””â”€â”€ database.py
â”‚   â”œâ”€â”€ api/                         # APIè·¯ç”±
â”‚   â”‚   â”œâ”€â”€ __init__.py
â”‚   â”‚   â”œâ”€â”€ v1/
â”‚   â”‚   â”‚   â”œâ”€â”€ __init__.py
â”‚   â”‚   â”‚   â”œâ”€â”€ analyze.py
â”‚   â”‚   â”‚   â”œâ”€â”€ generate.py
â”‚   â”‚   â”‚   â””â”€â”€ match.py
â”‚   â”œâ”€â”€ services/                    # ä¸šåŠ¡é€»è¾‘å±‚
â”‚   â”‚   â”œâ”€â”€ __init__.py
â”‚   â”‚   â”œâ”€â”€ llm_service.py
â”‚   â”‚   â”œâ”€â”€ rag_service.py          # LlamaIndex RAGæœåŠ¡
â”‚   â”‚   â”œâ”€â”€ vector_service.py       # Elasticsearchå‘é‡æœåŠ¡
â”‚   â”‚   â”œâ”€â”€ analysis_service.py
â”‚   â”‚   â””â”€â”€ generation_service.py
â”‚   â”œâ”€â”€ models/                      # æ•°æ®æ¨¡å‹
â”‚   â”‚   â”œâ”€â”€ __init__.py
â”‚   â”‚   â”œâ”€â”€ request.py
â”‚   â”‚   â””â”€â”€ response.py
â”‚   â”œâ”€â”€ core/                        # æ ¸å¿ƒç»„ä»¶
â”‚   â”‚   â”œâ”€â”€ __init__.py
â”‚   â”‚   â”œâ”€â”€ llama_index_config.py
â”‚   â”‚   â”œâ”€â”€ langchain_config.py
â”‚   â”‚   â””â”€â”€ elasticsearch_config.py
â”‚   â””â”€â”€ utils/                       # å·¥å…·å‡½æ•°
â”‚       â”œâ”€â”€ __init__.py
â”‚       â””â”€â”€ helpers.py
â”œâ”€â”€ requirements.txt
â”œâ”€â”€ Dockerfile
â””â”€â”€ .env
```

### FastAPIä¸»åº”ç”¨
```python
# main.py
from fastapi import FastAPI
from fastapi.middleware.cors import CORSMiddleware
from fastapi.middleware.gzip import GZipMiddleware
from contextlib import asynccontextmanager

from app.api.v1 import analyze, generate, match
from app.config.settings import settings
from app.core.llama_index_config import initialize_llama_index
from app.core.elasticsearch_config import initialize_elasticsearch

@asynccontextmanager
async def lifespan(app: FastAPI):
    # å¯åŠ¨æ—¶åˆå§‹åŒ–
    print("åˆå§‹åŒ–AIæœåŠ¡...")
    await initialize_llama_index()
    await initialize_elasticsearch()
    yield
    # å…³é—­æ—¶æ¸…ç†
    print("å…³é—­AIæœåŠ¡...")

app = FastAPI(
    title="AI Bid Composer - AI Service",
    description="AIèƒ½åŠ›æœåŠ¡ï¼Œæä¾›æ–‡æ¡£åˆ†æã€å†…å®¹ç”Ÿæˆç­‰æ™ºèƒ½åŠŸèƒ½",
    version="2.0.0",
    lifespan=lifespan
)

# CORSä¸­é—´ä»¶
app.add_middleware(
    CORSMiddleware,
    allow_origins=settings.ALLOWED_ORIGINS,
    allow_credentials=True,
    allow_methods=["*"],
    allow_headers=["*"],
)

# Gzipå‹ç¼©
app.add_middleware(GZipMiddleware, minimum_size=1000)

# æ³¨å†Œè·¯ç”±
app.include_router(analyze.router, prefix="/api/v1/analyze", tags=["analyze"])
app.include_router(generate.router, prefix="/api/v1/generate", tags=["generate"])
app.include_router(match.router, prefix="/api/v1/match", tags=["match"])

@app.get("/health")
async def health_check():
    return {
        "status": "healthy",
        "service": "ai-service",
        "version": "2.0.0"
    }

if __name__ == "__main__":
    import uvicorn
    uvicorn.run(
        "app.main:app",
        host="0.0.0.0",
        port=8001,
        reload=settings.DEBUG
    )

# é…ç½® - config/settings.py
from pydantic_settings import BaseSettings
from typing import List

class Settings(BaseSettings):
    # åº”ç”¨é…ç½®
    APP_NAME: str = "AI Bid Composer"
    DEBUG: bool = False
    ALLOWED_ORIGINS: List[str] = ["http://localhost:3000"]

    # æ•°æ®åº“é…ç½®
    POSTGRES_URL: str = "postgresql://user:pass@postgres:5432/aibid"

    # Redisé…ç½®
    REDIS_URL: str = "redis://redis:6379/0"

    # Elasticsearché…ç½®
    ELASTICSEARCH_URL: str = "http://elasticsearch:9200"
    ELASTICSEARCH_INDEX_PREFIX: str = "bid_"

    # LLM APIé…ç½®
    OPENAI_API_KEY: str
    ANTHROPIC_API_KEY: str = ""
    ZHIPU_API_KEY: str = ""

    # æ¨¡å‹é…ç½®
    DEFAULT_LLM_MODEL: str = "gpt-4"
    DEFAULT_EMBEDDING_MODEL: str = "text-embedding-3-small"
    DEFAULT_TEMPERATURE: float = 0.1
    MAX_TOKENS: int = 4000

    # RAGé…ç½®
    CHUNK_SIZE: int = 512
    CHUNK_OVERLAP: int = 50
    SIMILARITY_TOP_K: int = 5

    class Config:
        env_file = ".env"
        case_sensitive = True

settings = Settings()
```

### LlamaIndex RAGæœåŠ¡å®ç°
```python
# services/rag_service.py
from typing import List, Dict, Any, Optional
from llama_index.core import (
    VectorStoreIndex,
    ServiceContext,
    StorageContext,
    Document,
    Settings
)
from llama_index.vector_stores.elasticsearch import ElasticsearchStore
from llama_index.llms.openai import OpenAI
from llama_index.embeddings.openai import OpenAIEmbedding
from llama_index.core.node_parser import SentenceSplitter

from app.config.settings import settings
from app.core.elasticsearch_config import get_elasticsearch_client

class RAGService:
    """åŸºäºLlamaIndexçš„RAGæœåŠ¡"""

    def __init__(self):
        self.es_client = get_elasticsearch_client()

        # é…ç½®LLM
        Settings.llm = OpenAI(
            model=settings.DEFAULT_LLM_MODEL,
            temperature=settings.DEFAULT_TEMPERATURE,
            api_key=settings.OPENAI_API_KEY
        )

        # é…ç½®Embeddingæ¨¡å‹
        Settings.embed_model = OpenAIEmbedding(
            model=settings.DEFAULT_EMBEDDING_MODEL,
            api_key=settings.OPENAI_API_KEY
        )

        # é…ç½®æ–‡æœ¬åˆ†å‰²å™¨
        Settings.node_parser = SentenceSplitter(
            chunk_size=settings.CHUNK_SIZE,
            chunk_overlap=settings.CHUNK_OVERLAP
        )

        # åˆå§‹åŒ–å‘é‡å­˜å‚¨
        self.vector_store = ElasticsearchStore(
            index_name=f"{settings.ELASTICSEARCH_INDEX_PREFIX}knowledge",
            es_url=settings.ELASTICSEARCH_URL
        )

        # åˆ›å»ºå­˜å‚¨ä¸Šä¸‹æ–‡
        self.storage_context = StorageContext.from_defaults(
            vector_store=self.vector_store
        )

        # åˆ›å»ºç´¢å¼•
        self.index = VectorStoreIndex.from_vector_store(
            vector_store=self.vector_store
        )

    async def analyze_tender(
        self,
        tender_doc: str,
        analysis_type: str = "comprehensive"
    ) -> Dict[str, Any]:
        """åˆ†ææ‹›æ ‡æ–‡æ¡£"""

        # åˆ›å»ºæŸ¥è¯¢å¼•æ“
        query_engine = self.index.as_query_engine(
            similarity_top_k=settings.SIMILARITY_TOP_K,
            response_mode="tree_summarize"
        )

        # æ„å»ºåˆ†ææç¤º
        prompt = f"""
        è¯·è¯¦ç»†åˆ†æä»¥ä¸‹æ‹›æ ‡æ–‡æ¡£ï¼Œæå–å…³é”®ä¿¡æ¯ï¼š

        æ‹›æ ‡æ–‡æ¡£å†…å®¹ï¼š
        {tender_doc[:4000]}  # é™åˆ¶é•¿åº¦

        è¯·ä»ä»¥ä¸‹ç»´åº¦è¿›è¡Œåˆ†æï¼š
        1. é¡¹ç›®åŸºæœ¬ä¿¡æ¯ï¼ˆé¡¹ç›®åç§°ã€é¢„ç®—ã€æ—¶é—´ç­‰ï¼‰
        2. æŠ€æœ¯è¦æ±‚ï¼ˆæŠ€æœ¯è§„æ ¼ã€æ€§èƒ½æŒ‡æ ‡ç­‰ï¼‰
        3. å•†åŠ¡æ¡æ¬¾ï¼ˆä»˜æ¬¾æ–¹å¼ã€äº¤ä»˜è¦æ±‚ç­‰ï¼‰
        4. è¯„åˆ†æ ‡å‡†ï¼ˆæŠ€æœ¯åˆ†ã€å•†åŠ¡åˆ†ç­‰ï¼‰
        5. é£é™©å› ç´ ï¼ˆæŠ€æœ¯é£é™©ã€å•†åŠ¡é£é™©ç­‰ï¼‰
        6. æŠ•æ ‡å»ºè®®ï¼ˆç­–ç•¥å»ºè®®ã€æ³¨æ„äº‹é¡¹ç­‰ï¼‰

        è¯·ä»¥ç»“æ„åŒ–çš„JSONæ ¼å¼è¾“å‡ºç»“æœã€‚
        """

        # æ‰§è¡ŒæŸ¥è¯¢
        response = await query_engine.aquery(prompt)

        return {
            "analysis": response.response,
            "source_nodes": [
                {
                    "text": node.node.text,
                    "score": node.score,
                    "metadata": node.node.metadata
                }
                for node in response.source_nodes
            ],
            "confidence_score": self._calculate_confidence(response.source_nodes)
        }

    async def generate_content(
        self,
        requirements: Dict[str, Any],
        company_profile: Dict[str, Any],
        section: str,
        style: str = "professional"
    ) -> Dict[str, Any]:
        """ç”Ÿæˆæ ‡ä¹¦å†…å®¹"""

        # åˆ›å»ºæŸ¥è¯¢å¼•æ“
        query_engine = self.index.as_query_engine(
            similarity_top_k=settings.SIMILARITY_TOP_K,
            response_mode="compact"
        )

        # æ„å»ºç”Ÿæˆæç¤º
        prompt = f"""
        è¯·åŸºäºä»¥ä¸‹ä¿¡æ¯ç”Ÿæˆæ ‡ä¹¦çš„{section}éƒ¨åˆ†å†…å®¹ï¼š

        é¡¹ç›®è¦æ±‚ï¼š
        {requirements}

        å…¬å¸ä¿¡æ¯ï¼š
        {company_profile}

        ç”Ÿæˆè¦æ±‚ï¼š
        1. é£æ ¼ï¼š{style}ï¼ˆä¸“ä¸š/åˆ›æ–°/ä¿å®ˆï¼‰
        2. çªå‡ºå…¬å¸ä¼˜åŠ¿å’Œæ ¸å¿ƒç«äº‰åŠ›
        3. é’ˆå¯¹æ€§è§£å†³å®¢æˆ·éœ€æ±‚å’Œç—›ç‚¹
        4. ä½“ç°ä¸“ä¸šæ€§å’Œå¯ä¿¡åº¦
        5. ç»“æ„æ¸…æ™°ã€é€»è¾‘ä¸¥å¯†

        è¯·ç”Ÿæˆé«˜è´¨é‡ã€æœ‰è¯´æœåŠ›çš„å†…å®¹ã€‚
        """

        # æ‰§è¡ŒæŸ¥è¯¢ç”Ÿæˆ
        response = await query_engine.aquery(prompt)

        # è¯„ä¼°ç”Ÿæˆè´¨é‡
        quality_score = await self._assess_quality(response.response)

        return {
            "content": response.response,
            "quality_score": quality_score,
            "source_references": [
                node.node.text[:200] for node in response.source_nodes
            ]
        }

    async def index_documents(
        self,
        documents: List[Dict[str, Any]]
    ) -> Dict[str, Any]:
        """ç´¢å¼•æ–‡æ¡£åˆ°å‘é‡æ•°æ®åº“"""

        # è½¬æ¢ä¸ºLlamaIndex Documentå¯¹è±¡
        llama_docs = [
            Document(
                text=doc["content"],
                metadata=doc.get("metadata", {}),
                id_=doc.get("id")
            )
            for doc in documents
        ]

        # åˆ›å»ºç´¢å¼•
        index = VectorStoreIndex.from_documents(
            llama_docs,
            storage_context=self.storage_context
        )

        return {
            "indexed_count": len(documents),
            "index_name": self.vector_store.index_name,
            "status": "success"
        }

    async def semantic_search(
        self,
        query: str,
        filters: Optional[Dict[str, Any]] = None,
        top_k: int = 5
    ) -> List[Dict[str, Any]]:
        """è¯­ä¹‰æœç´¢"""

        # åˆ›å»ºæ£€ç´¢å™¨
        retriever = self.index.as_retriever(
            similarity_top_k=top_k
        )

        # æ‰§è¡Œæ£€ç´¢
        nodes = await retriever.aretrieve(query)

        return [
            {
                "text": node.node.text,
                "score": node.score,
                "metadata": node.node.metadata,
                "id": node.node.id_
            }
            for node in nodes
        ]

    def _calculate_confidence(self, source_nodes) -> float:
        """è®¡ç®—ç½®ä¿¡åº¦åˆ†æ•°"""
        if not source_nodes:
            return 0.0

        # åŸºäºæ£€ç´¢å¾—åˆ†è®¡ç®—ç½®ä¿¡åº¦
        avg_score = sum(node.score for node in source_nodes) / len(source_nodes)
        return min(avg_score, 1.0)

    async def _assess_quality(self, content: str) -> float:
        """è¯„ä¼°å†…å®¹è´¨é‡"""
        # ç®€å•çš„è´¨é‡è¯„ä¼°é€»è¾‘
        # å®é™…åº”ç”¨ä¸­å¯ä»¥ä½¿ç”¨æ›´å¤æ‚çš„è¯„ä¼°æ¨¡å‹

        factors = {
            "length": min(len(content) / 1000, 1.0) * 0.3,
            "structure": 0.4 if "\n\n" in content else 0.2,
            "professional": 0.3 if any(keyword in content for keyword in ["æŠ€æœ¯", "æ–¹æ¡ˆ", "å®æ–½"]) else 0.1
        }

        return sum(factors.values())

# è·å–RAGæœåŠ¡å®ä¾‹
_rag_service = None

def get_rag_service() -> RAGService:
    global _rag_service
    if _rag_service is None:
        _rag_service = RAGService()
    return _rag_service
```

### æ–‡æ¡£åˆ†æAPI
```python
# api/v1/analyze.py
from fastapi import APIRouter, HTTPException, BackgroundTasks
from typing import List, Optional
import time

from app.models.request import DocumentAnalysisRequest
from app.models.response import DocumentAnalysisResponse, ApiResponse
from app.services.rag_service import get_rag_service
from app.services.analysis_service import get_analysis_service

router = APIRouter()

@router.post("/document", response_model=ApiResponse[DocumentAnalysisResponse])
async def analyze_document(
    request: DocumentAnalysisRequest,
    background_tasks: BackgroundTasks
):
    """
    åˆ†ææ‹›æ ‡æ–‡æ¡£

    - **document_id**: æ–‡æ¡£ID
    - **document_content**: æ–‡æ¡£å†…å®¹
    - **document_type**: æ–‡æ¡£ç±»å‹ï¼ˆtender/proposal/contractï¼‰
    - **analysis_options**: åˆ†æé€‰é¡¹åˆ—è¡¨
    """
    start_time = time.time()

    try:
        rag_service = get_rag_service()
        analysis_service = get_analysis_service()

        # æ‰§è¡Œæ–‡æ¡£åˆ†æ
        analysis_results = await rag_service.analyze_tender(
            tender_doc=request.document_content,
            analysis_type="comprehensive"
        )

        # æå–éœ€æ±‚å’Œé£é™©
        requirements = await analysis_service.extract_requirements(
            request.document_content
        )
        risks = await analysis_service.analyze_risks(
            request.document_content
        )

        # è®¡ç®—å¤„ç†æ—¶é—´
        processing_time = time.time() - start_time

        response_data = DocumentAnalysisResponse(
            document_id=request.document_id,
            analysis_results={
                "main_analysis": analysis_results["analysis"],
                "requirements": requirements,
                "risks": risks,
                "source_nodes": analysis_results["source_nodes"]
            },
            confidence_score=analysis_results["confidence_score"],
            processing_time=processing_time
        )

        # åå°ä»»åŠ¡ï¼šä¿å­˜åˆ†æç»“æœ
        background_tasks.add_task(
            save_analysis_results,
            request.document_id,
            response_data.model_dump()
        )

        return ApiResponse(
            success=True,
            data=response_data,
            message="æ–‡æ¡£åˆ†æå®Œæˆ"
        )

    except Exception as e:
        raise HTTPException(
            status_code=500,
            detail=f"æ–‡æ¡£åˆ†æå¤±è´¥: {str(e)}"
        )

async def save_analysis_results(document_id: str, results: dict):
    """åå°ä»»åŠ¡ï¼šä¿å­˜åˆ†æç»“æœ"""
    # ä¿å­˜åˆ°æ•°æ®åº“æˆ–ç¼“å­˜
    pass

# models/request.py
from pydantic import BaseModel, Field
from typing import List, Optional

class DocumentAnalysisRequest(BaseModel):
    document_id: str = Field(..., description="æ–‡æ¡£ID")
    document_content: str = Field(..., description="æ–‡æ¡£å†…å®¹")
    document_type: str = Field(..., description="æ–‡æ¡£ç±»å‹")
    analysis_options: List[str] = Field(
        default=["requirements", "risks", "opportunities"],
        description="åˆ†æé€‰é¡¹"
    )

# models/response.py
from pydantic import BaseModel, Field
from typing import Dict, Any, Optional, Generic, TypeVar

T = TypeVar('T')

class ApiResponse(BaseModel, Generic[T]):
    success: bool = Field(..., description="æ˜¯å¦æˆåŠŸ")
    data: Optional[T] = Field(None, description="å“åº”æ•°æ®")
    message: str = Field("", description="å“åº”æ¶ˆæ¯")
    timestamp: str = Field(
        default_factory=lambda: datetime.utcnow().isoformat(),
        description="æ—¶é—´æˆ³"
    )

class DocumentAnalysisResponse(BaseModel):
    document_id: str = Field(..., description="æ–‡æ¡£ID")
    analysis_results: Dict[str, Any] = Field(..., description="åˆ†æç»“æœ")
    confidence_score: float = Field(..., description="ç½®ä¿¡åº¦åˆ†æ•°")
    processing_time: float = Field(..., description="å¤„ç†æ—¶é—´ï¼ˆç§’ï¼‰")
```

### å†…å®¹ç”ŸæˆAPI
```python
# api/v1/generate.py
from fastapi import APIRouter, HTTPException, BackgroundTasks
from typing import Dict, Any
import time

from app.models.request import ContentGenerationRequest
from app.models.response import ContentGenerationResponse, ApiResponse
from app.services.rag_service import get_rag_service
from app.services.generation_service import get_generation_service

router = APIRouter()

@router.post("/content", response_model=ApiResponse[ContentGenerationResponse])
async def generate_content(
    request: ContentGenerationRequest,
    background_tasks: BackgroundTasks
):
    """
    ç”Ÿæˆæ ‡ä¹¦å†…å®¹

    - **project_id**: é¡¹ç›®ID
    - **template_id**: æ¨¡æ¿ID
    - **requirements**: é¡¹ç›®è¦æ±‚
    - **company_profile**: å…¬å¸ä¿¡æ¯
    - **generation_options**: ç”Ÿæˆé€‰é¡¹
    """
    start_time = time.time()

    try:
        rag_service = get_rag_service()
        generation_service = get_generation_service()

        # ç”Ÿæˆå„ä¸ªç« èŠ‚å†…å®¹
        sections = {}

        # ç”Ÿæˆæ‰§è¡Œæ‘˜è¦
        if "executive_summary" in request.generation_options.get("sections", []):
            sections["executive_summary"] = await rag_service.generate_content(
                requirements=request.requirements,
                company_profile=request.company_profile,
                section="æ‰§è¡Œæ‘˜è¦",
                style="professional"
            )

        # ç”ŸæˆæŠ€æœ¯æ–¹æ¡ˆ
        if "technical_proposal" in request.generation_options.get("sections", []):
            sections["technical_proposal"] = await rag_service.generate_content(
                requirements=request.requirements,
                company_profile=request.company_profile,
                section="æŠ€æœ¯æ–¹æ¡ˆ",
                style="professional"
            )

        # ç”Ÿæˆç®¡ç†æ–¹æ¡ˆ
        if "management_approach" in request.generation_options.get("sections", []):
            sections["management_approach"] = await rag_service.generate_content(
                requirements=request.requirements,
                company_profile=request.company_profile,
                section="é¡¹ç›®ç®¡ç†æ–¹æ¡ˆ",
                style="professional"
            )

        # è¯„ä¼°æ•´ä½“è´¨é‡
        quality_score = await generation_service.assess_overall_quality(sections)

        # ç”Ÿæˆæ”¹è¿›å»ºè®®
        suggestions = await generation_service.generate_suggestions(
            sections,
            quality_score
        )

        processing_time = time.time() - start_time

        response_data = ContentGenerationResponse(
            generated_content={
                "sections": sections,
                "generation_metadata": {
                    "project_id": request.project_id,
                    "template_id": request.template_id,
                    "timestamp": datetime.utcnow().isoformat()
                }
            },
            quality_score=quality_score,
            suggestions=suggestions,
            processing_time=processing_time
        )

        return ApiResponse(
            success=True,
            data=response_data,
            message="å†…å®¹ç”Ÿæˆå®Œæˆ"
        )

    except Exception as e:
        raise HTTPException(
            status_code=500,
            detail=f"å†…å®¹ç”Ÿæˆå¤±è´¥: {str(e)}"
        )
```

## ğŸ’¾ æ•°æ®åº“è®¾è®¡è¯¦ç»†å®ç°

### PostgreSQLæ•°æ®åº“æ¶æ„
```sql
-- æ•°æ®åº“æ¶æ„è¯¦ç»†è®¾è®¡
-- åˆ›å»ºæ•°æ®åº“
CREATE DATABASE aibidcomposer;

-- ä½¿ç”¨ä¸»æ•°æ®åº“
\c aibidcomposer;

-- åˆ›å»ºæ‰©å±•
CREATE EXTENSION IF NOT EXISTS "uuid-ossp";
CREATE EXTENSION IF NOT EXISTS "pgcrypto";
CREATE EXTENSION IF NOT EXISTS "pg_trgm";

-- ä¼ä¸šä¿¡æ¯è¡¨
CREATE TABLE companies (
    id UUID PRIMARY KEY DEFAULT uuid_generate_v4(),
    name VARCHAR(200) NOT NULL,
    display_name VARCHAR(200),
    description TEXT,
    industry VARCHAR(100),
    company_size VARCHAR(50),
    website VARCHAR(500),
    logo_url VARCHAR(500),
    contact_email VARCHAR(200),
    contact_phone VARCHAR(50),

    -- è®¢é˜…ä¿¡æ¯
    subscription_tier VARCHAR(20) DEFAULT 'basic',
    subscription_status VARCHAR(20) DEFAULT 'active',
    subscription_expires_at TIMESTAMP,

    -- å®¡è®¡å­—æ®µ
    created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP,
    updated_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP,

    CONSTRAINT companies_name_unique UNIQUE (name)
);

-- ç”¨æˆ·è¡¨ï¼ˆå¦‚å‰æ‰€ç¤ºï¼‰
CREATE TABLE users (
    id UUID PRIMARY KEY DEFAULT uuid_generate_v4(),
    company_id UUID NOT NULL REFERENCES companies(id) ON DELETE CASCADE,
    username VARCHAR(50) NOT NULL,
    email VARCHAR(200) NOT NULL,
    password_hash VARCHAR(255) NOT NULL,
    full_name VARCHAR(100),
    role VARCHAR(20) NOT NULL DEFAULT 'user',
    is_active BOOLEAN DEFAULT true,
    is_verified BOOLEAN DEFAULT false,
    avatar_url VARCHAR(500),
    phone VARCHAR(20),
    department VARCHAR(100),
    position VARCHAR(100),
    created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP,
    updated_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP,
    last_login_at TIMESTAMP,

    CONSTRAINT users_username_unique UNIQUE (username),
    CONSTRAINT users_email_unique UNIQUE (email)
);

-- é¡¹ç›®è¡¨
CREATE TABLE projects (
    id UUID PRIMARY KEY DEFAULT uuid_generate_v4(),
    company_id UUID NOT NULL REFERENCES companies(id) ON DELETE CASCADE,
    created_by UUID NOT NULL REFERENCES users(id),
    name VARCHAR(200) NOT NULL,
    description TEXT,
    project_number VARCHAR(100),
    client_name VARCHAR(200),
    project_type VARCHAR(50),
    tender_document_url VARCHAR(500),
    submission_deadline TIMESTAMP,
    budget_amount DECIMAL(15,2),
    status VARCHAR(20) NOT NULL DEFAULT 'draft',
    priority VARCHAR(20) DEFAULT 'medium',
    created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP,
    updated_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP,

    CONSTRAINT projects_status_check CHECK (
        status IN ('draft', 'in_progress', 'review', 'approved', 'submitted', 'won', 'lost', 'cancelled')
    )
);

-- æ¨¡æ¿è¡¨
CREATE TABLE templates (
    id UUID PRIMARY KEY DEFAULT uuid_generate_v4(),
    company_id UUID REFERENCES companies(id) ON DELETE CASCADE,
    created_by UUID NOT NULL REFERENCES users(id),
    name VARCHAR(200) NOT NULL,
    description TEXT,
    category VARCHAR(50) NOT NULL,
    industry VARCHAR(100),
    content JSONB NOT NULL,
    structure JSONB,
    variables JSONB DEFAULT '{}',
    is_public BOOLEAN DEFAULT false,
    is_active BOOLEAN DEFAULT true,
    usage_count INTEGER DEFAULT 0,
    version INTEGER DEFAULT 1,
    created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP,
    updated_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP
);

-- æ–‡æ¡£è¡¨
CREATE TABLE documents (
    id UUID PRIMARY KEY DEFAULT uuid_generate_v4(),
    project_id UUID REFERENCES projects(id) ON DELETE CASCADE,
    template_id UUID REFERENCES templates(id),
    created_by UUID NOT NULL REFERENCES users(id),
    title VARCHAR(200) NOT NULL,
    document_type VARCHAR(50) NOT NULL,
    file_path VARCHAR(1000),
    file_size BIGINT,
    content JSONB,
    status VARCHAR(20) NOT NULL DEFAULT 'draft',
    quality_score DECIMAL(5,2),
    ai_generated BOOLEAN DEFAULT false,
    created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP,
    updated_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP,

    CONSTRAINT documents_status_check CHECK (
        status IN ('draft', 'review', 'approved', 'final', 'archived')
    )
);

-- ä¼ä¸šèƒ½åŠ›åº“è¡¨ï¼ˆå‘é‡å­˜å‚¨åœ¨Elasticsearchï¼‰
CREATE TABLE enterprise_capabilities (
    id UUID PRIMARY KEY DEFAULT uuid_generate_v4(),
    company_id UUID NOT NULL REFERENCES companies(id) ON DELETE CASCADE,
    created_by UUID NOT NULL REFERENCES users(id),
    name VARCHAR(200) NOT NULL,
    type VARCHAR(50) NOT NULL,
    description TEXT,
    metadata JSONB,
    tags TEXT[] DEFAULT '{}',
    is_active BOOLEAN DEFAULT true,
    created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP,
    updated_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP,

    CONSTRAINT capabilities_type_check CHECK (
        type IN ('product', 'service', 'project', 'personnel', 'technology', 'certification')
    )
);

-- åˆ›å»ºç´¢å¼•
CREATE INDEX idx_users_company_id ON users(company_id);
CREATE INDEX idx_users_email ON users(email);
CREATE INDEX idx_projects_company_id ON projects(company_id);
CREATE INDEX idx_projects_status ON projects(status);
CREATE INDEX idx_documents_project_id ON documents(project_id);
CREATE INDEX idx_capabilities_company_id ON enterprise_capabilities(company_id);

-- åˆ›å»ºæ›´æ–°æ—¶é—´è§¦å‘å™¨
CREATE OR REPLACE FUNCTION update_updated_at_column()
RETURNS TRIGGER AS $$
BEGIN
    NEW.updated_at = CURRENT_TIMESTAMP;
    RETURN NEW;
END;
$$ language 'plpgsql';

CREATE TRIGGER update_users_updated_at BEFORE UPDATE ON users
    FOR EACH ROW EXECUTE FUNCTION update_updated_at_column();

CREATE TRIGGER update_companies_updated_at BEFORE UPDATE ON companies
    FOR EACH ROW EXECUTE FUNCTION update_updated_at_column();

CREATE TRIGGER update_projects_updated_at BEFORE UPDATE ON projects
    FOR EACH ROW EXECUTE FUNCTION update_updated_at_column();
```

### Elasticsearchå‘é‡æ•°æ®åº“é…ç½®
```python
# core/elasticsearch_config.py
from elasticsearch import AsyncElasticsearch
from typing import Optional

from app.config.settings import settings

_es_client: Optional[AsyncElasticsearch] = None

async def initialize_elasticsearch():
    """åˆå§‹åŒ–Elasticsearchè¿æ¥"""
    global _es_client

    _es_client = AsyncElasticsearch(
        hosts=[settings.ELASTICSEARCH_URL],
        max_retries=3,
        retry_on_timeout=True
    )

    # åˆ›å»ºç´¢å¼•æ˜ å°„
    await create_vector_indexes()

    print("Elasticsearchåˆå§‹åŒ–å®Œæˆ")

async def create_vector_indexes():
    """åˆ›å»ºå‘é‡ç´¢å¼•"""

    # èƒ½åŠ›åº“å‘é‡ç´¢å¼•
    capabilities_mapping = {
        "mappings": {
            "properties": {
                "id": {"type": "keyword"},
                "type": {"type": "keyword"},
                "name": {"type": "text"},
                "description": {"type": "text"},
                "embedding": {
                    "type": "dense_vector",
                    "dims": 1536,
                    "similarity": "cosine"
                },
                "metadata": {
                    "properties": {
                        "industry": {"type": "keyword"},
                        "tags": {"type": "keyword"},
                        "experience": {"type": "integer"}
                    }
                }
            }
        }
    }

    index_name = f"{settings.ELASTICSEARCH_INDEX_PREFIX}capabilities"
    if not await _es_client.indices.exists(index=index_name):
        await _es_client.indices.create(
            index=index_name,
            body=capabilities_mapping
        )
        print(f"åˆ›å»ºç´¢å¼•: {index_name}")

def get_elasticsearch_client() -> AsyncElasticsearch:
    """è·å–Elasticsearchå®¢æˆ·ç«¯"""
    return _es_client
```

## ğŸš€ éƒ¨ç½²é…ç½®

### Docker Composeé…ç½®
```yaml
# docker-compose.yml
version: '3.8'

services:
  # å‰ç«¯åº”ç”¨
  frontend:
    build:
      context: ./frontend
      dockerfile: Dockerfile
    ports:
      - "3000:3000"
    environment:
      - VITE_JAVA_SERVICE_URL=http://java-service:8080/api/v1
      - VITE_AI_SERVICE_URL=http://python-ai-service:8001/api/v1
    depends_on:
      - java-service
      - python-ai-service

  # Javaä¸šåŠ¡æœåŠ¡
  java-service:
    build:
      context: ./java-service
      dockerfile: Dockerfile
    ports:
      - "8080:8080"
    environment:
      - SPRING_PROFILES_ACTIVE=production
      - SPRING_DATASOURCE_URL=jdbc:postgresql://postgres:5432/aibid
      - SPRING_DATASOURCE_USERNAME=aibid_user
      - SPRING_DATASOURCE_PASSWORD=aibid_pass
      - SPRING_REDIS_HOST=redis
      - SPRING_REDIS_PORT=6379
      - AI_SERVICE_URL=http://python-ai-service:8001
    depends_on:
      - postgres
      - redis
      - elasticsearch

  # Python AIæœåŠ¡
  python-ai-service:
    build:
      context: ./python-ai-service
      dockerfile: Dockerfile
    ports:
      - "8001:8001"
    environment:
      - OPENAI_API_KEY=${OPENAI_API_KEY}
      - ANTHROPIC_API_KEY=${ANTHROPIC_API_KEY}
      - ELASTICSEARCH_URL=http://elasticsearch:9200
      - POSTGRES_URL=postgresql://aibid_user:aibid_pass@postgres:5432/aibid
      - REDIS_URL=redis://redis:6379/0
    depends_on:
      - postgres
      - redis
      - elasticsearch

  # PostgreSQLæ•°æ®åº“
  postgres:
    image: postgres:15-alpine
    ports:
      - "5432:5432"
    environment:
      - POSTGRES_DB=aibid
      - POSTGRES_USER=aibid_user
      - POSTGRES_PASSWORD=aibid_pass
    volumes:
      - postgres_data:/var/lib/postgresql/data
      - ./init-db.sql:/docker-entrypoint-initdb.d/init-db.sql

  # Redisç¼“å­˜
  redis:
    image: redis:7-alpine
    ports:
      - "6379:6379"
    volumes:
      - redis_data:/data
    command: redis-server --appendonly yes

  # Elasticsearchå‘é‡æ•°æ®åº“
  elasticsearch:
    image: elasticsearch:8.11.0
    ports:
      - "9200:9200"
      - "9300:9300"
    environment:
      - discovery.type=single-node
      - xpack.security.enabled=false
      - "ES_JAVA_OPTS=-Xms2g -Xmx2g"
    volumes:
      - es_data:/usr/share/elasticsearch/data

  # MinIOå¯¹è±¡å­˜å‚¨
  minio:
    image: minio/minio:latest
    ports:
      - "9000:9000"
      - "9001:9001"
    environment:
      - MINIO_ROOT_USER=admin
      - MINIO_ROOT_PASSWORD=adminpassword
    volumes:
      - minio_data:/data
    command: server /data --console-address ":9001"

volumes:
  postgres_data:
  redis_data:
  es_data:
  minio_data:
```

### JavaæœåŠ¡Dockerfile
```dockerfile
# java-service/Dockerfile
FROM maven:3.9-eclipse-temurin-17 AS build

WORKDIR /app

# å¤åˆ¶pom.xmlå¹¶ä¸‹è½½ä¾èµ–
COPY pom.xml .
RUN mvn dependency:go-offline

# å¤åˆ¶æºä»£ç å¹¶æ„å»º
COPY src ./src
RUN mvn clean package -DskipTests

# è¿è¡Œé˜¶æ®µ
FROM eclipse-temurin:17-jre-alpine

WORKDIR /app

# å¤åˆ¶jaræ–‡ä»¶
COPY --from=build /app/target/*.jar app.jar

# æš´éœ²ç«¯å£
EXPOSE 8080

# å¯åŠ¨åº”ç”¨
ENTRYPOINT ["java", "-jar", "app.jar"]
```

### PythonæœåŠ¡Dockerfile
```dockerfile
# python-ai-service/Dockerfile
FROM python:3.11-slim

WORKDIR /app

# å®‰è£…ç³»ç»Ÿä¾èµ–
RUN apt-get update && apt-get install -y \
    gcc \
    g++ \
    && rm -rf /var/lib/apt/lists/*

# å¤åˆ¶requirements.txtå¹¶å®‰è£…ä¾èµ–
COPY requirements.txt .
RUN pip install --no-cache-dir -r requirements.txt

# å¤åˆ¶åº”ç”¨ä»£ç 
COPY . .

# æš´éœ²ç«¯å£
EXPOSE 8001

# å¯åŠ¨åº”ç”¨
CMD ["uvicorn", "app.main:app", "--host", "0.0.0.0", "--port", "8001"]
```

### Pythonä¾èµ–é…ç½®
```txt
# python-ai-service/requirements.txt
fastapi==0.104.1
uvicorn[standard]==0.24.0
pydantic==2.5.0
pydantic-settings==2.1.0

# AIæ¡†æ¶
llama-index==0.9.20
llama-index-vector-stores-elasticsearch==0.1.2
langchain==0.1.0
langchain-openai==0.0.2

# LLMå®¢æˆ·ç«¯
openai==1.6.0
anthropic==0.8.0

# æ•°æ®åº“å’Œç¼“å­˜
elasticsearch==8.11.0
redis==5.0.1
asyncpg==0.29.0
sqlalchemy==2.0.23

# å·¥å…·åº“
python-dotenv==1.0.0
python-multipart==0.0.6
python-jose[cryptography]==3.3.0
passlib[bcrypt]==1.7.4
```

---

*æ–‡æ¡£ç‰ˆæœ¬: v2.0*
*åˆ›å»ºæ—¶é—´: 2025å¹´11æœˆ15æ—¥*
*æ›´æ–°æ—¶é—´: 2025å¹´11æœˆ26æ—¥*
